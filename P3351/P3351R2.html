<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>P3351R2: views::scan</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
			border-bottom: 3px solid transparent;
			margin-bottom: -3px;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom-color: #054572;
			border-bottom-color: var(--toclink-underline);
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li a + span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
<style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      vertical-align: top;
    }
    th, td {
      border-left: none;
      border-right: none;
      padding: 0px 10px;
    }
    th {
      text-align: center;
    }

    del { background: #fcc; color: #000; text-decoration: line-through; }
    ins { background: #cfc; color: #000; }
    blockquote .highlight:not(.idl) { background: initial; margin: initial; padding: 0.5em }
    blockquote ul { background: inherit; }
    blockquote code.highlight:not(.idl) { padding: initial; }
    blockquote c-[a] { color: inherit; } /* Keyword.Declaration */
    blockquote c-[b] { color: inherit; } /* Keyword.Type */
    blockquote c-[c] { color: inherit; } /* Comment */
    blockquote c-[d] { color: inherit; } /* Comment.Multiline */
    blockquote c-[e] { color: inherit; } /* Name.Attribute */
    blockquote c-[f] { color: inherit; } /* Name.Tag */
    blockquote c-[g] { color: inherit; } /* Name.Variable */
    blockquote c-[k] { color: inherit; } /* Keyword */
    blockquote c-[l] { color: inherit; } /* Literal */
    blockquote c-[m] { color: inherit; } /* Literal.Number */
    blockquote c-[n] { color: inherit; } /* Name */
    blockquote c-[o] { color: inherit; } /* Operator */
    blockquote c-[p] { color: inherit; } /* Punctuation */
    blockquote c-[s] { color: inherit; } /* Literal.String */
    blockquote c-[t] { color: inherit; } /* Literal.String.Single */
    blockquote c-[u] { color: inherit; } /* Literal.String.Double */
    blockquote c-[cp] { color: inherit; } /* Comment.Preproc */
    blockquote c-[c1] { color: inherit; } /* Comment.Single */
    blockquote c-[cs] { color: inherit; } /* Comment.Special */
    blockquote c-[kc] { color: inherit; } /* Keyword.Constant */
    blockquote c-[kn] { color: inherit; } /* Keyword.Namespace */
    blockquote c-[kp] { color: inherit; } /* Keyword.Pseudo */
    blockquote c-[kr] { color: inherit; } /* Keyword.Reserved */
    blockquote c-[ld] { color: inherit; } /* Literal.Date */
    blockquote c-[nc] { color: inherit; } /* Name.Class */
    blockquote c-[no] { color: inherit; } /* Name.Constant */
    blockquote c-[nd] { color: inherit; } /* Name.Decorator */
    blockquote c-[ni] { color: inherit; } /* Name.Entity */
    blockquote c-[ne] { color: inherit; } /* Name.Exception */
    blockquote c-[nf] { color: inherit; } /* Name.Function */
    blockquote c-[nl] { color: inherit; } /* Name.Label */
    blockquote c-[nn] { color: inherit; } /* Name.Namespace */
    blockquote c-[py] { color: inherit; } /* Name.Property */
    blockquote c-[ow] { color: inherit; } /* Operator.Word */
    blockquote c-[mb] { color: inherit; } /* Literal.Number.Bin */
    blockquote c-[mf] { color: inherit; } /* Literal.Number.Float */
    blockquote c-[mh] { color: inherit; } /* Literal.Number.Hex */
    blockquote c-[mi] { color: inherit; } /* Literal.Number.Integer */
    blockquote c-[mo] { color: inherit; } /* Literal.Number.Oct */
    blockquote c-[sb] { color: inherit; } /* Literal.String.Backtick */
    blockquote c-[sc] { color: inherit; } /* Literal.String.Char */
    blockquote c-[sd] { color: inherit; } /* Literal.String.Doc */
    blockquote c-[se] { color: inherit; } /* Literal.String.Escape */
    blockquote c-[sh] { color: inherit; } /* Literal.String.Heredoc */
    blockquote c-[si] { color: inherit; } /* Literal.String.Interpol */
    blockquote c-[sx] { color: inherit; } /* Literal.String.Other */
    blockquote c-[sr] { color: inherit; } /* Literal.String.Regex */
    blockquote c-[ss] { color: inherit; } /* Literal.String.Symbol */
    blockquote c-[vc] { color: inherit; } /* Name.Variable.Class */
    blockquote c-[vg] { color: inherit; } /* Name.Variable.Global */
    blockquote c-[vi] { color: inherit; } /* Name.Variable.Instance */
    blockquote c-[il] { color: inherit; } /* Literal.Number.Integer.Long */
  </style>
  <meta content="Bikeshed version 742f3d674, updated Mon Nov 4 14:56:54 2024 -0800" name="generator">
  <link href="https://wg21.link/P3351R2" rel="canonical">
  <link href="https://isocpp.org/favicon.ico" rel="icon">
  <meta content="83609ef69c83eb168d4d191c161aa55d43eebab5" name="revision">
  <meta content="dark light" name="color-scheme">
<style>
table, th, td { border:1px solid grey; }
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">P3351R2<br><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code></h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Published Proposal, <time class="dt-updated" datetime="2025-01-12">2025-01-12</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wg21.link/P3351R2">https://wg21.link/P3351R2</a>
     <dt class="editor">Author:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:winmikedows@hotmail.com">Yihe Li</a>
     <dt>Audience:
     <dd>SG9
     <dt>Project:
     <dd>ISO/IEC 14882 Programming Languages — C++, ISO/IEC JTC1/SC22/WG21
     <dt>Target:
     <dd>C++26
     <dt>Source:
     <dd><a href="https://github.com/Mick235711/wg21-papers/blob/main/P3351/P3351R2.bs">github.com/Mick235711/wg21-papers/blob/main/P3351/P3351R2.bs</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/Mick235711/wg21-papers/issues">GitHub Mick235711/wg21-papers</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <hr title="Separator for header">
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#revisions"><span class="secno">1</span> <span class="content">Revision History</span></a>
     <ol class="toc">
      <li><a href="#r2"><span class="secno">1.1</span> <span class="content">R2 (2025-01 pre-Hagenberg Mailing)</span></a>
      <li><a href="#r1"><span class="secno">1.2</span> <span class="content">R1 (2024-10 pre-Wrocław Mailing)</span></a>
      <li><a href="#r0"><span class="secno">1.3</span> <span class="content">R0 (2024-07 post-St. Louis Mailing)</span></a>
     </ol>
    <li><a href="#motivation"><span class="secno">2</span> <span class="content">Motivation</span></a>
    <li>
     <a href="#design"><span class="secno">3</span> <span class="content">Design</span></a>
     <ol class="toc">
      <li><a href="#what-is-being-proposed"><span class="secno">3.1</span> <span class="content">What Is Being Proposed?</span></a>
      <li><a href="#prior-art"><span class="secno">3.2</span> <span class="content">Prior Art</span></a>
      <li><a href="#alternative-names"><span class="secno">3.3</span> <span class="content">Alternative Names</span></a>
      <li>
       <a href="#left-or-right-fold"><span class="secno">3.4</span> <span class="content">Left or Right Fold?</span></a>
       <ol class="toc">
        <li><a href="#left-right-sg9-review-wroclaw"><span class="secno">3.4.1</span> <span class="content">SG9 Review, Wrocław (2024-11)</span></a>
       </ol>
      <li><a href="#more-convenience-aliases"><span class="secno">3.5</span> <span class="content">More Convenience Aliases</span></a>
      <li>
       <a href="#range-properties"><span class="secno">3.6</span> <span class="content">Range Properties</span></a>
       <ol class="toc">
        <li><a href="#reference-and-value-type"><span class="secno">3.6.1</span> <span class="content">Reference and Value Type</span></a>
        <li><a href="#category"><span class="secno">3.6.2</span> <span class="content">Category</span></a>
        <li><a href="#common"><span class="secno">3.6.3</span> <span class="content">Common</span></a>
        <li><a href="#sized"><span class="secno">3.6.4</span> <span class="content">Sized</span></a>
        <li><a href="#const-iterable"><span class="secno">3.6.5</span> <span class="content">Const-Iterable</span></a>
        <li><a href="#borrowed"><span class="secno">3.6.6</span> <span class="content">Borrowed</span></a>
       </ol>
      <li><a href="#feature-test-macro"><span class="secno">3.7</span> <span class="content">Feature Test Macro</span></a>
      <li><a href="#freestanding"><span class="secno">3.8</span> <span class="content">Freestanding</span></a>
      <li><a href="#future-extensions"><span class="secno">3.9</span> <span class="content">Future Extensions</span></a>
     </ol>
    <li><a href="#implementation-experience"><span class="secno">4</span> <span class="content">Implementation Experience</span></a>
    <li>
     <a href="#questions"><span class="secno">5</span> <span class="content">Questions To Resolve</span></a>
     <ol class="toc">
      <li><a href="#questions-for-sg9"><span class="secno">5.1</span> <span class="content">Questions for SG9</span></a>
      <li><a href="#questions-for-lewg"><span class="secno">5.2</span> <span class="content">Questions for LEWG</span></a>
      <li><a href="#questions-for-lwg"><span class="secno">5.3</span> <span class="content">Questions for LWG</span></a>
     </ol>
    <li>
     <a href="#wording"><span class="secno">6</span> <span class="content">Wording</span></a>
     <ol class="toc">
      <li><a href="#version.syn"><span class="secno">6.1</span> <span class="content">17.3.2 Header <code class="highlight"><c- o>&lt;</c-><c- n>version</c-><c- o>></c-></code> synopsis [version.syn]</span></a>
      <li><a href="#ranges.syn"><span class="secno">6.2</span> <span class="content">25.2 Header <code class="highlight"><c- o>&lt;</c-><c- n>ranges</c-><c- o>></c-></code> synopsis [ranges.syn]</span></a>
      <li><a href="#range.scan"><span class="secno">6.3</span> <span class="content">25.7.� Scan view [range.scan]</span></a>
      <li><a href="#range.scan.overview"><span class="secno">6.4</span> <span class="content">25.7.�.1 Overview [range.scan.overview]</span></a>
      <li><a href="#range.scan.view"><span class="secno">6.5</span> <span class="content">25.7.�.2 Class template <code class="highlight"><c- n>scan_view</c-></code> [range.scan.view]</span></a>
      <li><a href="#range.scan.iterator"><span class="secno">6.6</span> <span class="content">25.7.�.3 Class template <code class="highlight"><c- n>scan_view</c-><c- o>::</c-><i><c- n>iterator</c-></i></code> [range.scan.iterator]</span></a>
     </ol>
    <li>
     <a href="#poll-results"><span class="secno">7</span> <span class="content">Poll Results</span></a>
     <ol class="toc">
      <li><a href="#sg9-review-wroclaw"><span class="secno">7.1</span> <span class="content">SG9 Review, Wrocław (2024-11)</span></a>
     </ol>
    <li>
     <a href="#historical-records"><span class="secno">8</span> <span class="content">Historical Records</span></a>
     <ol class="toc">
      <li>
       <a href="#why-three-adaptors"><span class="secno">8.1</span> <span class="content">Why Three Adaptors? (Obsolete)</span></a>
       <ol class="toc">
        <li><a href="#conflict-sg9-review-wroclaw"><span class="secno">8.1.1</span> <span class="content">SG9 Review, Wrocław (2024-11)</span></a>
       </ol>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <p>This paper proposes the <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> range adaptor family, which takes a range and a function that takes the current element <em>and</em> the current state as parameters. Basically, <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> is a lazy view version of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code>, or <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>transform</c-></code> with a stateful function. To make common usage of this adaptor easier, this paper also proposes <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code>, which is <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> with the binary function defaulted to <code class="highlight"><c- o>+</c-></code>.</p>
   <p>The <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> adaptor is classified as a Tier 1 item in the Ranges plan for C++26 (<a data-link-type="biblio" href="#biblio-p2760r1" title="A Plan for C++26 Ranges">[P2760R1]</a>).</p>
   <h2 class="heading settled" data-level="1" id="revisions"><span class="secno">1. </span><span class="content">Revision History</span><a class="self-link" href="#revisions"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="r2"><span class="secno">1.1. </span><span class="content">R2 (2025-01 pre-Hagenberg Mailing)</span><a class="self-link" href="#r2"></a></h3>
   <ul>
    <li data-md>
     <p>Redesigned the entire paper, following SG9’s feedback in Wrocław (2024-11). Significant changes since <a data-link-type="biblio" href="#biblio-p3351r1" title="views::scan">[P3351R1]</a> are:</p>
     <ul>
      <li data-md>
       <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> is now equivalent to <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code>, both in terms of argument sequence (<code class="highlight"><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>,</c-> <c- n>init</c-></code>) and also the semantics.</p>
      <li data-md>
       <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>prescan</c-></code> is removed as it did not gain enough support and have no prior experience in the STL.</p>
      <li data-md>
       <p>The prior arts section is redesigned:</p>
       <ul>
        <li data-md>
         <p>Added STL algorithm to prior arts section, and also reformat the table.</p>
        <li data-md>
         <p>More languages like Kotlin and Haskell are added.</p>
       </ul>
      <li data-md>
       <p>After the parameter sequence change, conflict between range and initial value is no longer an issue, thus removing this workaround which previously prevent the with-initial-value version to overload with the normal version. As a result, now <code class="highlight"><c- n>scan</c-></code> and <code class="highlight"><c- n>partial_sum</c-></code> supports an optional initial value.</p>
      <li data-md>
       <p>A section is added to explore the relationship with parallel range algorithms in general.</p>
      <li data-md>
       <p>Group the wording question into different groups based on audience.</p>
     </ul>
    <li data-md>
     <p>Added poll results section and several review results sections.</p>
    <li data-md>
     <p>Added some minor correction and discussion on reference type.</p>
    <li data-md>
     <p>Added some discussion on naming comflicts with <a data-link-type="biblio" href="#biblio-p1729r5" title="Text Parsing">[P1729R5]</a>.</p>
    <li data-md>
     <p>Several wording fixes:</p>
     <ul>
      <li data-md>
       <p>Fixed the mismatch template arguments for <code class="highlight"><c- n>scan_view</c-></code> in synopsis.</p>
      <li data-md>
       <p>Add <em>italics</em> for exposition-only concepts.</p>
     </ul>
    <li data-md>
     <p>Preemptively add <code class="highlight"><c- n>reserve_hint</c-></code> members in anticipation of <a data-link-type="biblio" href="#biblio-p2846r5" title="reserve_hint: Eagerly reserving memory for not-quite-sized lazy ranges">[P2846R5]</a>'s acceptance.</p>
    <li data-md>
     <p>Rebase onto latest draft <a data-link-type="biblio" href="#biblio-n5001" title="Working Draft, Programming Languages — C++">[N5001]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="1.2" id="r1"><span class="secno">1.2. </span><span class="content">R1 (2024-10 pre-Wrocław Mailing)</span><a class="self-link" href="#r1"></a></h3>
   <ul>
    <li data-md>
     <p>Several wording fixes:</p>
     <ul>
      <li data-md>
       <p>Added the missing <code class="highlight"><c- k>noexcept</c-></code> to <code class="highlight"><c- n>end</c-><c- p>()</c-></code>.</p>
      <li data-md>
       <p>Refactored the constraints of <code class="highlight"><c- n>scan_view</c-></code> out into its own concept, such that it tests for both assignability from <code class="highlight"><c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>R</c-><c- o>></c-></code> and the invoke result of <code class="highlight"><c- n>f</c-></code>.</p>
      <li data-md>
       <p>Replace <code class="highlight"><c- n>regular_invocable</c-></code> with <code class="highlight"><c- n>invocable</c-></code>.</p>
      <li data-md>
       <p>Pass by move in <code class="highlight"><c- n>scan_view</c-></code>’s constructor and when invoking the function.</p>
     </ul>
    <li data-md>
     <p>Rebase onto latest draft <a data-link-type="biblio" href="#biblio-n4988" title="Working Draft, Programming Languages — C++">[N4988]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="1.3" id="r0"><span class="secno">1.3. </span><span class="content">R0 (2024-07 post-St. Louis Mailing)</span><a class="self-link" href="#r0"></a></h3>
   <ul>
    <li data-md>
     <p>Initial revision.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="motivation"><span class="secno">2. </span><span class="content">Motivation</span><a class="self-link" href="#motivation"></a></h2>
   <p>The motivation for this view is given in <a data-link-type="biblio" href="#biblio-p2760r1" title="A Plan for C++26 Ranges">[P2760R1]</a> and quoted below for convenience:</p>
   <blockquote>
    <p>If you want to take a range of elements and get a new range that is applying <code class="highlight"><c- n>f</c-></code> to every element, that’s <code class="highlight"><c- n>transform</c-><c- p>(</c-><c- n>f</c-><c- p>)</c-></code>. But there are many cases where you need a <code class="highlight"><c- n>transform</c-></code> to that is stateful. That is, rather than have the input to <code class="highlight"><c- n>f</c-></code> be the current element (and require that <code class="highlight"><c- n>f</c-></code> be <code class="highlight"><c- n>regular_invocable</c-></code>), have the input to <code class="highlight"><c- n>f</c-></code> be both the current element and the current state.</p>
    <p>For instance, given the range <code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>5</c-><c- p>]</c-></code>, if you want to produce the range <code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>10</c-><c- p>,</c-> <c- mi>15</c-><c- p>]</c-></code> - you can’t get there with <code class="highlight"><c- n>transform</c-></code>. Instead, you need to use <code class="highlight"><c- n>scan</c-></code> using <code class="highlight"><c- o>+</c-></code> as the binary operator. The special case of <code class="highlight"><c- n>scan</c-></code> over <code class="highlight"><c- o>+</c-></code> is partial_sum.</p>
    <p>One consideration here is how to process the first element. You might want <code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>10</c-><c- p>,</c-> <c- mi>15</c-><c- p>]</c-></code> and you might want <code class="highlight"><c- p>[</c-><c- mi>0</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>10</c-><c- p>,</c-> <c- mi>15</c-><c- p>]</c-></code> (with one extra element), the latter could be called a <code class="highlight"><c- n>prescan</c-></code>.</p>
   </blockquote>
   <p>This adaptor is also present in ranges-v3, where it is called <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code> with the function parameter defaulted to <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{}</c-></code>. However, as <a data-link-type="biblio" href="#biblio-p2760r1" title="A Plan for C++26 Ranges">[P2760R1]</a> rightfully pointed out, <code class="highlight"><c- n>partial_sum</c-></code> is probably not suitable for a generic operation like this that can do much more than just calculating partial sum, similar to how <code class="highlight"><c- n>accumulate</c-></code> is not a suitable name for a general fold. Therefore, the more generic <code class="highlight"><c- n>scan</c-></code> name is chosen to reflect the nature of this operation. (More discussion on the naming are present in the later sections.)</p>
   <h2 class="heading settled" data-level="3" id="design"><span class="secno">3. </span><span class="content">Design</span><a class="self-link" href="#design"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="what-is-being-proposed"><span class="secno">3.1. </span><span class="content">What Is Being Proposed?</span><a class="self-link" href="#what-is-being-proposed"></a></h3>
   <p>Scan is a pretty common operation in functional programming. On its simplest form, scanning a sequence <code class="highlight"><c- n>x0</c-><c- p>,</c-> <c- n>x1</c-><c- p>,</c-> <c- n>x2</c-><c- p>,</c-> <c- p>...</c-></code> gives you back the sequence <code class="highlight"><c- n>x0</c-><c- p>,</c-> <c- n>x0</c-> <c- o>+</c-> <c- n>x1</c-><c- p>,</c-> <c- n>x0</c-> <c- o>+</c-> <c- n>x1</c-> <c- o>+</c-> <c- n>x2</c-><c- p>,</c-> <c- p>...</c-></code>, essentially doing a prefix sum. When generalizing <code class="highlight"><c- o>+</c-></code> to an arbitrary binary function, scan become a form of "partial" fold, in which fold-like operation is performed but with intermediate result preserved.</p>
   <p>There are two forms of scan defined in a mathematical sense: <em>inclusive</em> scan and <em>exclusive</em> scan. An inclusive scan includes <code class="highlight"><c- n>i</c-></code>-th term of the original sequence when computing the <code class="highlight"><c- n>i</c-></code>-th term of the resulting sequence, while the exclusive scan does not. Inclusive scan may optionally include an initial seed <code class="highlight"><c- n>s</c-></code> that will be used to compute the first output term, while exclusive scan requires an initial seed as the first output term directly. When summarized in a table, both forms of scan looks like this:</p>
   <table>
    <tbody>
     <tr>
      <td>Original
      <td><code class="highlight"><c- n>x0</c-></code>
      <td><code class="highlight"><c- n>x1</c-></code>
      <td><code class="highlight"><c- n>x2</c-></code>
      <td><code class="highlight"><c- n>x3</c-></code>
     <tr>
      <td>Inclusive
      <td><code class="highlight"><c- n>x0</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>x0</c-><c- p>,</c-> <c- n>x1</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>x0</c-><c- p>,</c-> <c- n>x1</c-><c- p>),</c-> <c- n>x2</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>x0</c-><c- p>,</c-> <c- n>x1</c-><c- p>),</c-> <c- n>x2</c-><c- p>),</c-> <c- n>x3</c-><c- p>)</c-></code>
     <tr>
      <td>Inclusive<br>With Seed
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>),</c-> <c- n>x1</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>),</c-> <c- n>x1</c-><c- p>),</c-> <c- n>x2</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>),</c-> <c- n>x1</c-><c- p>),</c-> <c- n>x2</c-><c- p>),</c-> <c- n>x3</c-><c- p>)</c-></code>
     <tr>
      <td>Exclusive
      <td><code class="highlight"><c- n>s</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>),</c-> <c- n>x1</c-><c- p>)</c-></code>
      <td><code class="highlight"><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>f</c-><c- p>(</c-><c- n>s</c-><c- p>,</c-> <c- n>x0</c-><c- p>),</c-> <c- n>x1</c-><c- p>),</c-> <c- n>x2</c-><c- p>)</c-></code>
   </table>
   <p>We can see clearly that both forms of scan are easily interconvertible, as shifting the inclusive scan result right once, prepend the initial seed, and drop the last term gives you the exclusive scan result. Another critical characteristic of exclusive scan is that they disregard the last input term to preserve the length of the sequence.</p>
   <p>In light of this, a third, more general scan semantics was implemented by some languages (like Haskell’s <code class="highlight"><c- n>scanl</c-></code>): Prepend the initial seed, but does not drop the last term. This is called <code class="highlight"><c- n>prescan</c-></code> semantics in previous revisions of this proposal, and has the notable characteristic that the resulting sequence will be one longer than the input. When applied to the sequence <code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>5</c-><c- p>]</c-></code> and using addition as the binary function, the three scan semantics gives the following results:</p>
   <table>
    <tbody>
     <tr>
      <td>Original
      <td><code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>5</c-><c- p>]</c-></code>
     <tr>
      <td>Inclusive
      <td><code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>10</c-><c- p>,</c-> <c- mi>15</c-><c- p>]</c-></code>
     <tr>
      <td>Inclusive<br>With Seed <code class="highlight"><c- mi>10</c-></code>
      <td><code class="highlight"><c- p>[</c-><c- mi>11</c-><c- p>,</c-> <c- mi>13</c-><c- p>,</c-> <c- mi>16</c-><c- p>,</c-> <c- mi>20</c-><c- p>,</c-> <c- mi>25</c-><c- p>]</c-></code>
     <tr>
      <td>Exclusive<br>With Seed <code class="highlight"><c- mi>10</c-></code>
      <td><code class="highlight"><c- p>[</c-><c- mi>10</c-><c- p>,</c-> <c- mi>11</c-><c- p>,</c-> <c- mi>13</c-><c- p>,</c-> <c- mi>16</c-><c- p>,</c-> <c- mi>20</c-><c- p>]</c-></code>
     <tr>
      <td><code class="highlight"><c- n>prescan</c-></code><br>With Seed <code class="highlight"><c- mi>10</c-></code>
      <td><code class="highlight"><c- p>[</c-><c- mi>10</c-><c- p>,</c-> <c- mi>11</c-><c- p>,</c-> <c- mi>13</c-><c- p>,</c-> <c- mi>16</c-><c- p>,</c-> <c- mi>20</c-><c- p>,</c-> <c- mi>25</c-><c- p>]</c-></code>
   </table>
   <p>C++ STL provides <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>partial_sum</c-></code> and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code> (latter since C++17) with the inclusive semantics, and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>exclusive_scan</c-></code> (since C++17) with the exclusive semantics. Previous revisions of this proposal proposes both the inclusive and the <code class="highlight"><c- n>prescan</c-></code> semantics, while the current revision only proposes the inclusive semantics. As can be seen in the Prior Arts sections below, inclusive semantics is the most commonly used and provided semantic in most languages, and other two semantics can be easily constructed by manipulating the inclusive result with existing range adaptors:</p>
<pre class="language-cpp highlight"><c- n>exclusive_scan</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>,</c-> <c- n>init</c-><c- p>)</c-> <c- o>=</c-> <c- n>concat</c-><c- p>(</c-><c- n>single</c-><c- p>(</c-><c- n>init</c-><c- p>),</c-> <c- n>scan</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>,</c-> <c- n>init</c-><c- p>)</c-> <c- o>|</c-> <c- n>drop_last</c-><c- p>(</c-><c- mi>1</c-><c- p>))</c->
<c- n>prescan</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>,</c-> <c- n>init</c-><c- p>)</c-> <c- o>=</c-> <c- n>concat</c-><c- p>(</c-><c- n>single</c-><c- p>(</c-><c- n>init</c-><c- p>),</c-> <c- n>scan</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>,</c-> <c- n>init</c-><c- p>))</c->
</pre>
   <p>Therefore, the author thinks that providing only the inclusive semantics is sufficient.</p>
   <h3 class="heading settled" data-level="3.2" id="prior-art"><span class="secno">3.2. </span><span class="content">Prior Art</span><a class="self-link" href="#prior-art"></a></h3>
   <p>The scan adaptor/algorithm had made an appearance in many different libraries and languages:</p>
   <ul>
    <li data-md>
     <p>range-v3 has a <a href="https://ericniebler.github.io/range-v3/structranges_1_1partial__sum__view.html"><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code> adaptor</a> that don’t take initial seeds, but takes arbitrary function parameter (defaults to <code class="highlight"><c- o>+</c-></code>).</p>
     <ul>
      <li data-md>
       <p>range-v3 also has an <a href="https://ericniebler.github.io/range-v3/structranges_1_1exclusive__scan__view.html"><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>exclusive_scan</c-></code> adaptor</a> that implements exclusive scan semantics. Its initial seed parameter is mandatory, but also takes an optional function parameter.</p>
     </ul>
    <li data-md>
     <p>STL has <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>partial_sum</c-></code> algorithm in <code class="highlight"><c- o>&lt;</c-><c- n>numeric</c-><c- o>></c-></code> since C++98, and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- p>[</c-><c- n>in</c-><c- p>,</c-> <c- n>ex</c-><c- p>]</c-><c- n>clusive_scan</c-></code> algorithms in <code class="highlight"><c- o>&lt;</c-><c- n>numeric</c-><c- o>></c-></code> since C++17.</p>
    <li data-md>
     <p><a href="https://github.com/TartanLlama/ranges/blob/main/include/tl/partial_sum.hpp"><code class="highlight"><c- n>tl</c-><c- o>::</c-><c- n>ranges</c-></code> also has an implementation of <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code>.</a></p>
    <li data-md>
     <p>Python has an <a href="https://docs.python.org/3/library/itertools.html#itertools.accumulate"><code class="highlight"><c- n>itertools</c-><c- p>.</c-><c- n>accumulate</c-></code> algorithm</a> that optionally takes initial seeds (with a named argument), and takes arbitrary function parameter (defaults to <code class="highlight"><c- o>+</c-></code>).</p>
     <ul>
      <li data-md>
       <p>Furthermore, NumPy provides <a href="https://numpy.org/doc/stable/reference/generated/numpy.cumsum.html"><code class="highlight"><c- n>cumsum</c-></code> algorithm</a> that returns a partial sum (without function parameter), and an <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.accumulate.html"><code class="highlight"><c- n>ufunc</c-><c- p>.</c-><c- n>accumulate</c-></code> algorithm</a> that performs arbitrary scans with arbitrary function parameter that have no default. Neither of those algorithms takes an initial seed.</p>
     </ul>
    <li data-md>
     <p>Rust has an <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#method.scan"><code class="highlight"><c- n>iter</c-><c- p>.</c-><c- n>scan</c-></code> adaptor</a> that takes initial seeds and arbitrary function parameters (no defaults provided). Kotlin also provides a <a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin.collections/scan.html"><code class="highlight"><c- n>scan</c-></code> member</a> that works similarly.</p>
    <li data-md>
     <p>Haskell provides two variants of left scan: <a href="https://hackage.haskell.org/package/base-4.21.0.0/docs/Prelude.html#v:scanl1"><code class="highlight"><c- n>scanl1</c-></code></a> and <a href="https://hackage.haskell.org/package/base-4.21.0.0/docs/Prelude.html#v:scanl"><code class="highlight"><c- n>scanl</c-></code></a>. The former performs an inclusive scan, but does not permit an initial seed. The latter performs a <code class="highlight"><c- n>prescan</c-></code>-like operation that preserve both the initial seed provided and the last fold result, resulting in a one-larger range than passed in.</p>
   </ul>
   <p>Summarized in a table (without additional note, all functions provide inclusive scan semantics):</p>
   <table>
    <thead>
     <tr>
      <td>Library
      <td>Signature
      <td>Parameter
      <td>Function
      <td>With<br>Default
      <td>Initial<br>Seed
    <tbody>
     <tr>
      <td colspan="6"><strong>Lazy Adaptors</strong>
     <tr>
      <td rowspan="2">range-v3 /<br><code class="highlight"><c- n>tl</c-><c- o>::</c-><c- n>ranges</c-></code>
      <td><code class="highlight"><c- n>partial_sum</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>[,</c-> <c- n>fun</c-><c- p>])</c-></code>
      <td>✅
      <td>✅
      <td>❌
     <tr>
      <td><code class="highlight"><c- n>exclusive_scan</c-></code><br>(Exclusive semantics)
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>init</c-><c- p>[,</c-> <c- n>fun</c-><c- p>])</c-></code>
      <td>✅
      <td>✅
      <td>✅
     <tr>
      <td rowspan="2">Proposed
      <td><code class="highlight"><c- n>scan</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>[,</c-> <c- n>init</c-><c- p>])</c-></code>
      <td>✅
      <td>❌
      <td>✅
     <tr>
      <td><code class="highlight"><c- n>partial_sum</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>[,</c-> <c- n>init</c-><c- p>])</c-></code>
      <td>❌
      <td>N/A
      <td>✅
     <tr>
      <td colspan="6"><strong>Eager Algorithms</strong>
     <tr>
      <td rowspan="3">STL
      <td><code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>partial_sum</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>out</c-><c- p>[,</c-> <c- n>func</c-><c- p>])</c-></code>
      <td>✅
      <td>✅
      <td>❌
     <tr>
      <td><code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>out</c-><c- p>[,</c-> <c- n>func</c-><c- p>[,</c-> <c- n>init</c-><c- p>]])</c-></code>
      <td>✅
      <td>✅
      <td>✅
     <tr>
      <td><code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>exclusive_scan</c-></code><br>(Exclusive semantics)
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>out</c-><c- p>,</c-> <c- n>init</c-><c- p>[,</c-> <c- n>func</c-><c- p>])</c-></code>
      <td>✅
      <td>✅
      <td>✅
     <tr>
      <td>Python<br><code class="highlight"><c- n>itertools</c-></code>
      <td><code class="highlight"><c- n>accumulate</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>[,</c-> <c- n>fun</c-><c- p>[,</c-> <c- n>init</c-><c- o>=</c-><c- n>init</c-><c- p>]])</c-></code>
      <td>✅
      <td>✅
      <td>✅
     <tr>
      <td rowspan="2">NumPy
      <td><code class="highlight"><c- n>cumsum</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>)</c-></code>
      <td>❌
      <td>N/A
      <td>❌
     <tr>
      <td><code class="highlight"><c- o>&lt;</c-><c- n>func</c-><c- o>></c-><c- p>.</c-><c- n>accumulate</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>rng</c-><c- p>)</c-></code>
      <td>✅
      <td>❌
      <td>❌
     <tr>
      <td>Rust
      <td><code class="highlight"><c- n>iter</c-><c- p>.</c-><c- n>scan</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>init</c-><c- p>,</c-> <c- n>func</c-><c- p>)</c-></code>
      <td>✅
      <td>❌
      <td>✅
     <tr>
      <td>Kotlin
      <td><code class="highlight"><c- o>&lt;</c-><c- n>rng</c-><c- o>></c-><c- p>.</c-><c- n>scan</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>init</c-><c- p>,</c-> <c- n>func</c-><c- p>)</c-></code>
      <td>✅
      <td>❌
      <td>✅
     <tr>
      <td rowspan="2">Haskell
      <td><code class="highlight"><c- n>scanl1</c-></code>
      <td><code class="highlight"><c- p>(</c-><c- n>func</c-><c- p>,</c-> <c- n>rng</c-><c- p>)</c-></code>
      <td>✅
      <td>❌
      <td>❌
     <tr>
      <td><code class="highlight"><c- n>scanl</c-></code><br>(<code class="highlight"><c- n>prescan</c-></code> semantics)
      <td><code class="highlight"><c- p>(</c-><c- n>func</c-><c- p>,</c-> <c- n>init</c-><c- p>,</c-> <c- n>rng</c-><c- p>)</c-></code>
      <td>✅
      <td>❌
      <td>✅
   </table>
   <h3 class="heading settled" data-level="3.3" id="alternative-names"><span class="secno">3.3. </span><span class="content">Alternative Names</span><a class="self-link" href="#alternative-names"></a></h3>
   <p>The author thinks <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> and <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code> are pretty good names. The former have prior example in <code class="highlight"><c- n>std</c-><c- o>::</c-><c- p>[</c-><c- n>in</c-><c- p>,</c-><c- n>ex</c-><c- p>]</c-><c- n>clusive_scan</c-></code> and in Rust/Kotlin, and is a generic enough name that will not cause confusion. The latter also have prior example in <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>partial_sum</c-></code>, and partial sum is definitely one of the canonical terms of describing this operation.</p>
   <p>However, one possible naming conflict recently has arisen: <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>scan</c-></code> (<a data-link-type="biblio" href="#biblio-p1729r5" title="Text Parsing">[P1729R5]</a>). Here, the name <code class="highlight"><c- n>scan</c-></code> refers to a completely different concept: scanning user’s input, and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>scan</c-></code> is proposed as an upgraded version of the <code class="highlight"><c- n>scanf</c-></code> family and uses <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>format</c-></code>-like syntax to parse variables from a given string input:</p>
<pre class="language-cpp highlight"><c- k>auto</c-> <c- n>result</c-> <c- o>=</c-> <c- n>std</c-><c- o>::</c-><c- n>scan</c-><c- o>&lt;</c-><c- n>std</c-><c- o>::</c-><c- n>string</c-><c- p>,</c-> <c- b>int</c-><c- o>></c-><c- p>(</c-><c- s>"answer = 42"</c-><c- p>,</c-> <c- s>"{} = {}"</c-><c- p>);</c->
<c- k>const</c-> <c- k>auto</c-><c- o>&amp;</c-> <c- p>[</c-><c- n>key</c-><c- p>,</c-> <c- n>value</c-><c- p>]</c-> <c- o>=</c-> <c- n>result</c-><c- o>-></c-><c- n>values</c-><c- p>();</c->
<c- c1>// key == "answer", value == 42</c->
</pre>
   <p>As noted above, this interpretation of the name <code class="highlight"><c- n>scan</c-></code> also has precedence in the standard library: the <code class="highlight"><c- n>scanf</c-></code> family, so this meaning also makes some sense.</p>
   <p>Notice that <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>scan</c-></code> and <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> do not conflict with each other since these two names are in different namespaces. However, it may be of interest to SG9/LEWG to rename <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> to a different name in order to avoid user confusion about two unrelated facilities being named the same. In light of this, the following list of alternative names is provided for consideration:</p>
   <p>Alternative names considered for <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code>: (in order of decreasing preference)</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_fold</c-></code> (suggested by <a data-link-type="biblio" href="#biblio-p2214r2" title="A Plan for C++23 Ranges">[P2214R2]</a>, and makes the connection with <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold</c-></code> clear): Pretty good name, since <code class="highlight"><c- n>scan</c-></code> is just a <code class="highlight"><c- n>fold</c-></code> with intermediate state saved. However, the correct analogy is actually <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold_left_first</c-></code>, and <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold_left</c-></code> actually corresponds to an exclusive scan, which the author felt may cause some confusion.</p>
    <li data-md>
     <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>inclusive_scan</c-></code>: Makes the equivalence with the STL numeric algorithm clear, and have no conflict potential with <code class="highlight"><c- n>scanf</c-></code> anymore. However, the author felt that this name is a bit too long.</p>
    <li data-md>
     <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>accumulate</c-></code>, <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>fold</c-></code>, <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>fold_left</c-></code>: The output is a range instead of a number, so using the same name probably is not accurate. The latter two also suffer from the same displaced correspondence problem.</p>
   </ul>
   <p>Alternative names considered for <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code>: (in order of decreasing preference)</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>prefix_sum</c-></code>: Another canonical term for this operation, but doesn’t have prior examples.</p>
    <li data-md>
     <p><code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>cumsum</c-></code> or <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>cumulative_sum</c-></code>: Have prior example in NumPy, but in the spirit of Ranges naming we probably need to choose the latter which is a bit long.</p>
   </ul>
   <p>Overall, the author doesn’t find any of these options particularly intriguing and opts to propose the original naming of <code class="highlight"><c- n>scan</c-></code> and <code class="highlight"><c- n>partial_sum</c-></code>. This does not actually conflict with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>scan</c-></code>, and besides, the standard library is already adopting two meanings of <code class="highlight"><c- n>scan</c-></code> by introducing both <code class="highlight"><c- n>scanf</c-></code> and <code class="highlight"><c- n>std</c-><c- o>::</c-><c- p>[</c-><c- n>in</c-><c- p>,</c-> <c- n>ex</c-><c- p>]</c-><c- n>clusive_scan</c-></code>, so it shouldn’t be that much of a confusion risk to the users.</p>
   <h3 class="heading settled" data-level="3.4" id="left-or-right-fold"><span class="secno">3.4. </span><span class="content">Left or Right Fold?</span><a class="self-link" href="#left-or-right-fold"></a></h3>
   <p>Theoretically, there are two possible direction of scanning a range:</p>
<pre class="language-cpp highlight"><c- c1>// rng = [x1, x2, x3, ...]</c->
<c- n>scan_left</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>f</c-><c- p>,</c-> <c- n>i</c-><c- p>)</c-> <c- c1>// [x1, f(x1, x2), f(f(x1, x2), x3), ...]</c->
<c- n>scan_right</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>f</c-><c- p>,</c-> <c- n>i</c-><c- p>)</c-> <c- c1>// [x1, f(x2, x1), f(x3, f(x2, x1)), ...]</c->
</pre>
   <p>Both are certainly viable, which begs the question: Should we provide both?</p>
   <p>On the one hand, <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold</c-></code> provided both the left and the right fold version, despite the fact that right fold can be simulated by reversing the range and the function parameter order. However, here, the simulation is even easier: just reversing the order of the function parameters will turn a left scan to a right scan.</p>
   <p>Furthermore, all of the mentioned prior arts perform left scan, and it is hard to come up with a valid use case of right scan that cannot be easily covered by left scan. Therefore, the author only proposes left scan in this proposal.</p>
   <h4 class="heading settled" data-level="3.4.1" id="left-right-sg9-review-wroclaw"><span class="secno">3.4.1. </span><span class="content">SG9 Review, Wrocław (2024-11)</span><a class="self-link" href="#left-right-sg9-review-wroclaw"></a></h4>
    SG9 agreed that only left scan is needed, since a right scan can be easily simulated by flipping the arguments of the function provided. The fundamental difference between <code class="highlight"><c- n>fold</c-></code> and <code class="highlight"><c- n>scan</c-></code> here is that <code class="highlight"><c- n>fold</c-></code> requires both reversing the range <em>and</em> flipping the arguments when changing from left to right, while <code class="highlight"><c- n>scan</c-></code> only requires the latter. 
   <h3 class="heading settled" data-level="3.5" id="more-convenience-aliases"><span class="secno">3.5. </span><span class="content">More Convenience Aliases</span><a class="self-link" href="#more-convenience-aliases"></a></h3>
   <p>Obviously, there are more aliases that can be provided besides <code class="highlight"><c- n>partial_sum</c-></code>. The three most useful aliases are:</p>
<pre class="language-cpp highlight"><c- n>std</c-><c- o>::</c-><c- n>vector</c-><c- o>&lt;</c-><c- b>int</c-><c- o>></c-> <c- n>vec</c-><c- p>{</c-><c- mi>3</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>6</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>1</c-><c- p>,</c-> <c- mi>9</c-><c- p>,</c-> <c- mi>0</c-><c- p>,</c-> <c- mi>7</c-><c- p>,</c-> <c- mi>5</c-><c- p>,</c-> <c- mi>8</c-><c- p>}</c->
<c- n>partial_sum</c-><c- p>(</c-><c- n>vec</c-><c- p>)</c-> <c- c1>// [3, 7, 13, 15, 16, 25, 25, 32, 37, 45]</c->
<c- n>partial_product</c-><c- p>(</c-><c- n>vec</c-><c- p>)</c-> <c- c1>// [3, 12, 72, 144, 144, 1296, 0, 0, 0, 0]</c->
<c- n>running_min</c-><c- p>(</c-><c- n>vec</c-><c- p>)</c-> <c- c1>// [3, 3, 3, 2, 1, 1, 0, 0, 0, 0]</c->
<c- n>running_max</c-><c- p>(</c-><c- n>vec</c-><c- p>)</c-> <c- c1>// [3, 4, 6, 6, 6, 9, 9, 9, 9, 9]</c->
</pre>
   <p>Which are the results of applying <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{}</c-></code>, <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>multiplies</c-><c- p>{}</c-></code>, <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>min</c-></code>, and <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>max</c-></code>.</p>
   <p>Looking at the results, these are certainly very useful aliases, even as useful as <code class="highlight"><c- n>partial_sum</c-></code>. However, as stated above, all of these three aliases can be achieved by simply passing the corresponding function object (currently, <code class="highlight"><c- n>min</c-></code>/<code class="highlight"><c- n>max</c-></code> doesn’t have a function object, but <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>min</c-></code> and <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>max</c-></code> become useable after <a data-link-type="biblio" href="#biblio-p3136r1" title="Retiring niebloids">[P3136R1]</a> was adopted in Wrocław (2024-11)) as the function parameter, so I’m not sure it is worth the hassle of specification. Therefore, currently this proposal do not include the other three aliases, but the author is happy to add them should SG9/LEWG request.</p>
   <p>As for <code class="highlight"><c- n>partial_sum</c-></code> itself, there are several reasons why this alias should be added, that is certainly stronger than the case for <code class="highlight"><c- n>product</c-></code>, <code class="highlight"><c- n>min</c-></code> and <code class="highlight"><c- n>max</c-></code>:</p>
   <ul>
    <li data-md>
     <p>All existing implementation of scan-like algorithm defaults the function argument to <code class="highlight"><c- o>+</c-></code> whenever there is a default.</p>
    <li data-md>
     <p><code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>partial_sum</c-></code> exists</p>
    <li data-md>
     <p>Partial sum is one of the most studied and used concept in programming, arguably even more useful than running min/max.</p>
   </ul>
   <p>One remaining question is whether <code class="highlight"><c- n>partial_sum</c-></code> should be a standalone adaptor alias, or should it be folded into <code class="highlight"><c- n>scan</c-></code> as the default function parameter. On the one hand, range-v3’s <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code> does this folding by using a function parameter defaults to <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{}</c-></code>. On the other hand, the author thinks that this will definitely cause some confusion to the users, due to the fact that a generic name like <code class="highlight"><c- n>scan</c-></code> defaults to <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>plus</c-></code> as its function parameter:</p>
<pre class="language-cpp highlight"><c- n>vec</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>scan</c-> <c- c1>// what should this mean?</c->
</pre>
   <p>This is similar to the scenario encountered by <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold</c-></code> (<a data-link-type="biblio" href="#biblio-p2322r6" title="ranges::fold">[P2322R6]</a>), where despite the old algorithm <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>accumulate</c-></code> took <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>plus</c-></code> as the default function parameter, <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold</c-></code> still choose to not have a default. The author feels that the same should be done for <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> (i.e. no default function), and introduce a separate <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code> alias that more clearly convey the intent.</p>
   <h3 class="heading settled" data-level="3.6" id="range-properties"><span class="secno">3.6. </span><span class="content">Range Properties</span><a class="self-link" href="#range-properties"></a></h3>
   <p>All three proposed views are range adaptors, i.e. can be piped into. <code class="highlight"><c- n>partial_sum</c-></code> is just an alias for <code class="highlight"><c- n>scan</c-><c- p>(</c-><c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{})</c-></code>, so it will not be mentioned in the below analysis.</p>
   <h4 class="heading settled" data-level="3.6.1" id="reference-and-value-type"><span class="secno">3.6.1. </span><span class="content">Reference and Value Type</span><a class="self-link" href="#reference-and-value-type"></a></h4>
   <p>Consider the following:</p>
<pre class="language-cpp highlight"><c- n>std</c-><c- o>::</c-><c- n>vector</c-><c- o>&lt;</c-><c- b>double</c-><c- o>></c-> <c- n>vec</c-><c- p>{</c-><c- mf>1.0</c-><c- p>,</c-> <c- mf>1.5</c-><c- p>,</c-> <c- mf>2.0</c-><c- p>};</c->
<c- n>vec</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c-><c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{},</c-> <c- mi>1</c-><c- p>);</c->
</pre>
   <p>Obviously, we expect the result to be <code class="highlight"><c- p>[</c-><c- mf>1.0</c-><c- p>,</c-> <c- mf>2.0</c-><c- p>,</c-> <c- mf>3.5</c-><c- p>,</c-> <c- mf>5.5</c-><c- p>]</c-></code>, not <code class="highlight"><c- p>[</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>5</c-><c- p>]</c-></code>, therefore for <code class="highlight"><c- n>scan</c-></code> we cannot just use the initial seed’s type as the resulting range’s reference/value type.</p>
   <p>There are two choices we can make: (for input range type <code class="highlight"><c- n>Rng</c-></code>, function type <code class="highlight"><c- n>F</c-></code> and initial seed type <code class="highlight"><c- n>T</c-></code>)</p>
   <ol>
    <li data-md>
     <p>Just use the reference/value type of the input range. This is consistent with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>partial_sum</c-></code>. (range-v3 also chose this approach, using the input range’s value type as the reference type of <code class="highlight"><c- n>scan_view</c-></code>)</p>
    <li data-md>
     <p>Be a bit clever, and use <code class="highlight"><c- n>decay_t</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>ranges</c-><c- o>::</c-><c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>Rng</c-><c- o>>>></c-></code>. In other words, the return type of <code class="highlight"><c- n>func</c-><c- p>(</c-><c- n>init</c-><c- p>,</c-> <c- o>*</c-><c- n>rng</c-><c- p>.</c-><c- n>begin</c-><c- p>())</c-></code>.</p>
   </ol>
   <p>Note that the second option don’t really covers all kind of functions, since it is entirely plausible that <code class="highlight"><c- n>func</c-></code> will change its return type in every invocation. However, this should be enough for nearly all normal cases, and is the decision chosen by <a data-link-type="biblio" href="#biblio-p2322r6" title="ranges::fold">[P2322R6]</a> for <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold_left</c-><c- p>[</c-><c- n>_first</c-><c- p>]</c-></code>. For <code class="highlight"><c- n>scan</c-></code> without an initial seed, this approach can also work, by returning the return type of <code class="highlight"><c- n>func</c-><c- p>(</c-><c- o>*</c-><c- n>rng</c-><c- p>.</c-><c- n>begin</c-><c- p>(),</c-> <c- o>*</c-><c- n>rng</c-><c- p>.</c-><c- n>begin</c-><c- p>())</c-></code>.</p>
   <p>Although the second choice is a bit complex in design, it also avoids the following footgun:</p>
<pre class="language-cpp highlight"><c- n>std</c-><c- o>::</c-><c- n>vector</c-><c- o>&lt;</c-><c- b>int</c-><c- o>></c-> <c- n>vec</c-><c- p>{</c-><c- mi>1</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>2147483647</c-><c- p>,</c-> <c- mi>3</c-><c- p>};</c->
<c- n>vec</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c-><c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{},</c-> <c- mf>0L</c-><c- p>);</c->
</pre>
   <p>With the first choice, the resulting range’s value type will be <code class="highlight"><c- b>int</c-></code>, which would result in UB due to overflow. With the second choice the resulting value type will be <code class="highlight"><c- b>long</c-></code> which is fine. (Unfortunately, if you omit the initial seed here it will still be UB, and that cannot be fixed.)</p>
   <p>The second choice also enables the following use case:</p>
<pre class="language-cpp highlight"><c- c1>// Assumes that std::to_string also has an overload for std::string that just returns the argument</c->
<c- n>std</c-><c- o>::</c-><c- n>vector</c-><c- o>&lt;</c-><c- b>int</c-><c- o>></c-> <c- n>vec</c-><c- p>{</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>};</c->
<c- n>vec</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c->
    <c- p>[](</c-><c- k>const</c-> <c- k>auto</c-><c- o>&amp;</c-> <c- n>a</c-><c- p>,</c-> <c- k>const</c-> <c- k>auto</c-><c- o>&amp;</c-> <c- n>b</c-><c- p>)</c-> <c- p>{</c-> <c- k>return</c-> <c- n>std</c-><c- o>::</c-><c- n>to_string</c-><c- p>(</c-><c- n>a</c-><c- p>)</c-> <c- o>+</c-> <c- n>std</c-><c- o>::</c-><c- n>to_string</c-><c- p>(</c-><c- n>b</c-><c- p>);</c-> <c- p>},</c->
    <c- s>"2"</c->
<c- p>)</c-> <c- c1>// ["21", "212", "2123"]</c->
</pre>
   <p>Given that <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold_left</c-><c- p>[</c-><c- n>_first</c-><c- p>]</c-></code> chose the second approach, the author thinks that the second approach is the correct one to pursue. In other words, the value type of <code class="highlight"><c- n>scan_view</c-></code> will be <code class="highlight"><c- n>decay_t</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>ranges</c-><c- o>::</c-><c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>Rng</c-><c- o>>>></c-></code>, and the reference type will be <code class="highlight"><c- k>const</c-> <c- n>value_type</c-><c- o>&amp;</c-></code>.</p>
   <h4 class="heading settled" data-level="3.6.2" id="category"><span class="secno">3.6.2. </span><span class="content">Category</span><a class="self-link" href="#category"></a></h4>
   <p>At most forward. (In other words, forward if the input range is forward, otherwise input.)</p>
   <p>The resulting range cannot be bidirectional, since the function parameter cannot be applied in reverse. A future extension may enable a <code class="highlight"><c- n>scan</c-></code> with both forward and backward function parameter, but that is outside the scope of this paper.</p>
   <h4 class="heading settled" data-level="3.6.3" id="common"><span class="secno">3.6.3. </span><span class="content">Common</span><a class="self-link" href="#common"></a></h4>
   <p>Never.</p>
   <p>This is consistent with range-v3’s implementation. The reasoning is that each iterator needs to store both the current position and the current partial sum (generalized), so that the <code class="highlight"><c- n>end</c-><c- p>()</c-></code> position’s iterator is not readily available in O(1) time.</p>
   <h4 class="heading settled" data-level="3.6.4" id="sized"><span class="secno">3.6.4. </span><span class="content">Sized</span><a class="self-link" href="#sized"></a></h4>
   <p>If and only if the input range is sized. The reported size is always equal to the input range’s size.</p>
   <p>Also, given that <a data-link-type="biblio" href="#biblio-p2846r5" title="reserve_hint: Eagerly reserving memory for not-quite-sized lazy ranges">[P2846R5]</a> is on track to be adopted for C++26, <code class="highlight"><c- n>scan_view</c-></code> also adapted that proposal by adding <code class="highlight"><c- n>reserve_hint</c-><c- p>()</c-></code> members who forwards the underlying view’s <code class="highlight"><c- n>reserve_hint</c-><c- p>()</c-></code> result appropriately.</p>
   <h4 class="heading settled" data-level="3.6.5" id="const-iterable"><span class="secno">3.6.5. </span><span class="content">Const-Iterable</span><a class="self-link" href="#const-iterable"></a></h4>
   <p>Similar to <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>transform</c-></code>, if and only if the input range is const-iterable and <code class="highlight"><c- n>func</c-></code> is <code class="highlight"><c- k>const</c-></code>-invocable.</p>
   <h4 class="heading settled" data-level="3.6.6" id="borrowed"><span class="secno">3.6.6. </span><span class="content">Borrowed</span><a class="self-link" href="#borrowed"></a></h4>
   <p>Never.</p>
   <p>At least for now. Currently, <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>transform</c-></code> is never borrowed, but after <a data-link-type="biblio" href="#biblio-p3117r1" title="Extending Conditionally Borrowed">[P3117R1]</a> determined suitable criteria for storing the function parameter in the iterator, it can be conditionally borrowed.</p>
   <p>Theoretically, the same can be applied to <code class="highlight"><c- n>scan_view</c-></code> to make it conditionally borrowed by storing the function and the initial value inside the iterator. However, the author would like to wait until <a data-link-type="biblio" href="#biblio-p3117r1" title="Extending Conditionally Borrowed">[P3117R1]</a> lands to make this change.</p>
   <h3 class="heading settled" data-level="3.7" id="feature-test-macro"><span class="secno">3.7. </span><span class="content">Feature Test Macro</span><a class="self-link" href="#feature-test-macro"></a></h3>
   <p>This proposal added a new feature test macro <code class="highlight"><c- n>__cpp_lib_ranges_scan</c-></code>, which signals the availability of both <code class="highlight"><c- n>scan</c-></code> and <code class="highlight"><c- n>partial_sum</c-></code> adaptors.</p>
   <h3 class="heading settled" data-level="3.8" id="freestanding"><span class="secno">3.8. </span><span class="content">Freestanding</span><a class="self-link" href="#freestanding"></a></h3>
   <p><a data-link-type="biblio" href="#biblio-p1642r11" title="Freestanding Library: Easy [utilities], [ranges], and [iterators]">[P1642R11]</a> included nearly everything in <code class="highlight"><c- o>&lt;</c-><c- n>ranges</c-><c- o>></c-></code> into freestanding, except <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>istream</c-></code> and the corresponding view types. However, range adaptors added after <a data-link-type="biblio" href="#biblio-p1642r11" title="Freestanding Library: Easy [utilities], [ranges], and [iterators]">[P1642R11]</a>, like <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>concat</c-></code> and <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>enumerate</c-></code> did not include themselves in freestanding.</p>
   <p>The author assumes that this is an oversight, since I cannot see any reason for those views to not be in freestanding. As a result, the range adaptor proposed by this paper will be included in freestanding. (Adding freestanding markers to the two views mentioned above is probably out of scope for this paper, but if LWG decides that this paper should also solve that oversight, the author is happy to comply.)</p>
   <h3 class="heading settled" data-level="3.9" id="future-extensions"><span class="secno">3.9. </span><span class="content">Future Extensions</span><a class="self-link" href="#future-extensions"></a></h3>
   <p>Several future extensions to the proposed <code class="highlight"><c- n>scan</c-></code> adaptor are possible and seen in other languages. These are outside the scope of this proposal and are only listed here as a record for inspiration.</p>
   <p>One obvious extension is to provide a variant that allows functions that operate on indexes, similar to Kotlin’s <a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin.collections/scan-indexed.html"><code class="highlight"><c- n>scanIndexed</c-></code> member</a>:</p>
<pre class="language-cpp highlight"><c- o>>>></c-> <c- n>scanIndexed</c-><c- p>([</c-><c- s>"a"</c-><c- p>,</c-> <c- s>"b"</c-><c- p>,</c-> <c- s>"c"</c-><c- p>],</c-> <c- s>"start"</c-><c- p>,</c-> <c- n>lambda</c-> <c- n>index</c-><c- p>,</c-> <c- n>acc</c-><c- p>,</c-> <c- n>elem</c-><c- o>:</c-> <c- n>acc</c-> <c- o>+</c-> <c- n>f</c-><c- s>", {index}: {elem}"</c-><c- p>)</c->
<c- p>[</c-><c- s>"start, 0: a"</c-><c- p>,</c-> <c- s>"start, 0: a, 1: b"</c-><c- p>,</c-> <c- s>"start, 0: a, 1: b, 2: c"</c-><c- p>]</c->
</pre>
   <p>This is already achievable in C++ by using <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>enumerate</c-></code> and manually unpacking the tuple elements inside the function. A direct <code class="highlight"><c- n>scan_indexed</c-></code> adaptor would be more convenient but ultimately does not provide new functionalities that cannot be achieved using existing tools, so it is not proposed.</p>
   <p>Another extension concerns the parallelism potential for the scan algorithm. At first glance, scan seems to be a completely serial algorithm that cannot be paralleled, as each term depends on the previous intermediate result. However, by iteratively performing the scanned function, the algorithm can actually be paralleled and can be completed in logarithmic time regarding to the number of elements when parallel resources are abundant. See <a href="https://en.wikipedia.org/wiki/Prefix_sum#Parallel_algorithms">the Wikipedia page</a> for details.</p>
   <p>In light of this, concerns are raised about the proposed <code class="highlight"><c- n>scan</c-></code> adaptor in that it does not permit this kind of reorder for paralleled execution:</p>
<pre class="language-cpp highlight"><c- c1>// Previous: two passes, two launches, each paralleled</c->
<c- n>ranges</c-><c- o>::</c-><c- n>inclusive_scan</c-><c- p>(</c-><c- n>par</c-><c- p>,</c-> <c- n>rng</c-><c- p>,</c-> <c- n>rng</c-><c- p>);</c->
<c- n>ranges</c-><c- o>::</c-><c- n>transform</c-><c- p>(</c-><c- n>par</c-><c- p>,</c-> <c- n>rng</c-><c- p>,</c-> <c- n>some_func</c-><c- p>);</c->

<c- c1>// After: one pass but actually serial</c->
<c- n>ranges</c-><c- o>::</c-><c- n>transform</c-><c- p>(</c-><c- n>par</c-><c- p>,</c-> <c- n>rng</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-><c- p>,</c-> <c- n>some_func</c-><c- p>);</c->
</pre>
   <p>This is due to the fact that <code class="highlight"><c- n>scan_view</c-></code> is at most forward, and thus, all the scanning operations can only be performed in sequence.</p>
   <p>However, the author is unable to find a satisfactory solution to this problem. With the C++ iterator model, efficient paralleled algorithm execution is <strong>only</strong> possible with random access iterator/range inputs, as referring to an arbitrary point in the iteration space at a constant time is often an integral part of the algorithm. Although C++17 parallel algorithms generally only require forward iterators, in practice, most implementations (like libstdc++ and libc++) will <em>de facto</em> require random access iterators to enable parallelism and silently fall back to serial execution with lower categories. Existing third-party parallel libraries like OpenMP and oneTBB also nearly always require random access iterators in their algorithms.</p>
   <p>Yet, it is impossible to make <code class="highlight"><c- n>scan_view</c-></code> a random access range. Doing so will not only require a way to get the previous results (probably through an additional reversal functor) but also requires efficient computation of the N-th element in the output range, which by definition requires N execution of the function and thus is impossible to be made efficient. The parallel algorithm for scan requires a substantially different iterator/adaptor model that allows efficient and arbitrary chunking of inner operations, which the C++ iterator model does not permit.</p>
   <p>This is a similar problem faced by <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>filter</c-></code>. On its own, <code class="highlight"><c- n>filter_view</c-></code> is at most bidirectional regardless of inputs, which makes it impossible to be execute efficiently using standard parallel algorithms and most third-party libraries as it is never random access. However, a natural parallel algorithm exists for <code class="highlight"><c- n>filter_view</c-></code>: just filter whatever element you are processing in parallel and exit the current thread/worker if the filter returns <code class="highlight">false</code>. Unfortunately, this is not expressible as the iterator advancement is strictly tied to the filter operation.</p>
   <p>There are several possible mitigation strategies for this problem, but none of them are complete:</p>
   <ul>
    <li data-md>
     <p>Add named algorithms. For instance, given that <code class="highlight"><c- n>filter_view</c-></code> is not paralleled, C++17 provided a parallel <code class="highlight"><c- n>copy_if</c-></code> to provide the desired semantics. However, algorithms are not composable (which is the whole reason that range adaptors are introduced), and using parallel STL algorithms like <code class="highlight"><c- n>copy_if</c-></code> and <code class="highlight"><c- n>inclusive_scan</c-></code> in lieu of adaptors leads to suboptimal performance (due to <code class="highlight"><c- n>copy_if</c-></code> needs some synchronization for writing the output while <code class="highlight"><c- n>filter</c-></code> does not) and the multi-launch problem described above.</p>
    <li data-md>
     <p>Add named algorithms for compositions. For instance, to solve the transform + scan multi-launch problem, STL directly provides <code class="highlight"><c- n>transform_</c-><c- p>{</c-><c- n>in</c-><c- p>,</c-><c- n>ex</c-><c- p>}</c-><c- n>clusive_scan</c-></code>, whose paralleled version can perform two operations in one launch. However, compositions are infinite, and STL cannot provide every composition as named algorithms (the above scan + transform operation, for instance, is not provided).</p>
    <li data-md>
     <p>Special-case the range adaptors. For instance, paralleled <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>transform</c-></code> can identify the <code class="highlight"><c- n>scan_view</c-></code> being passed in and utilize <code class="highlight"><c- n>base</c-><c- p>()</c-></code> and functor members to do the parallelization. However, this solution is brittle, cannot handle complex pipelines, and requires substantial work for all algorithms.</p>
   </ul>
   <p>Ultimately, the C++20 range adaptor is not a good abstraction for parallelism, and complex pipelines using adaptors are inherently only able to be executed serially. The parallelism problem is not unique to <code class="highlight"><c- n>scan_view</c-></code>, and substantial changes to both the adaptor and iterator model (perhaps somehow separate the advancement and compute stages) are required to enable sufficient parallelism opportunities even for long pipeline compositions, which are best explored in a separate proposal. Fortunately, at least the current range parallel algorithm proposal <a data-link-type="biblio" href="#biblio-p3179r4" title="C++ parallel range algorithms">[P3179R4]</a> wisely restricted the input to be random access, so the above scan + transform invocation will result in a compile error instead of silently degrading to serial performance.</p>
   <h2 class="heading settled" data-level="4" id="implementation-experience"><span class="secno">4. </span><span class="content">Implementation Experience</span><a class="self-link" href="#implementation-experience"></a></h2>
   <p>The author implemented this proposal in <a href="https://godbolt.org/z/qMvEhWKf9">Compiler Explorer</a>. No significant obstacles are observed.</p>
   <h2 class="heading settled" data-level="5" id="questions"><span class="secno">5. </span><span class="content">Questions To Resolve</span><a class="self-link" href="#questions"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="questions-for-sg9"><span class="secno">5.1. </span><span class="content">Questions for SG9</span><a class="self-link" href="#questions-for-sg9"></a></h3>
   <ul>
    <li data-md>
     <p>Should the naming be <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>inclusive_scan</c-></code> to avoid conflict?</p>
    <li data-md>
     <p>Should the function parameter have a default?</p>
    <li data-md>
     <p>Do we need <code class="highlight"><c- k>operator</c-><c- o>-</c-></code> for <code class="highlight"><c- n>sized_sentinel_for</c-></code>? Between two iterators of <code class="highlight"><c- n>scan_view</c-></code> and/or between iterators of <code class="highlight"><c- n>scan_view</c-></code> and iterators of base range? Between iterator and sentinel?</p>
     <ul>
      <li data-md>
       <p>range-v3’s <code class="highlight"><c- n>partial_sum_view</c-></code> does not have <code class="highlight"><c- k>operator</c-><c- o>-</c-></code>, but <code class="highlight"><c- n>tl</c-><c- o>::</c-><c- n>ranges</c-></code>’s does.</p>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="5.2" id="questions-for-lewg"><span class="secno">5.2. </span><span class="content">Questions for LEWG</span><a class="self-link" href="#questions-for-lewg"></a></h3>
   <ul>
    <li data-md>
     <p>Currently, the current sum is cached in the iterator object (as implemented in range-v3). An alternative is to cache the current sum in the view object (as implemented in <code class="highlight"><c- n>tl</c-><c- o>::</c-><c- n>ranges</c-></code>), such that each iterator only needs to hold a pointer to the parent view and an iterator to the current position. Which one should be chosen?</p>
    <li data-md>
     <p><code class="highlight"><c- n>regular_invocable</c-></code> or <code class="highlight"><c- n>invocable</c-></code>? Currently the wording uses the latter (following range-v3), but <code class="highlight"><c- n>transform_view</c-></code> used the former.</p>
   </ul>
   <h3 class="heading settled" data-level="5.3" id="questions-for-lwg"><span class="secno">5.3. </span><span class="content">Questions for LWG</span><a class="self-link" href="#questions-for-lwg"></a></h3>
   <ul>
    <li data-md>
     <p>Due to never being a common range, <code class="highlight"><c- n>scan_view</c-></code> simply have a single <code class="highlight"><c- n>end</c-><c- p>()</c-> <c- k>const</c-></code> member that returns <code class="highlight"><c- n>default_sentinel</c-></code>. Is that the correct way to do this, or should I just use the end iterator of the base range?</p>
    <li data-md>
     <p>The extra <code class="highlight"><c- b>bool</c-> <c- n>IsInit</c-></code> parameter seems a bit clunky.</p>
   </ul>
   <h2 class="heading settled" data-level="6" id="wording"><span class="secno">6. </span><span class="content">Wording</span><a class="self-link" href="#wording"></a></h2>
   <p>The wording below is based on <a data-link-type="biblio" href="#biblio-n5001" title="Working Draft, Programming Languages — C++">[N5001]</a> with <a data-link-type="biblio" href="#biblio-p2846r5" title="reserve_hint: Eagerly reserving memory for not-quite-sized lazy ranges">[P2846R5]</a> already applied on top.</p>
   <p>Wording notes for LWG and editor:</p>
   <ul>
    <li data-md>
     <p>Currently, the three views' definition reside just after <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>transform</c-></code>’s definition and synopsis, due to the author’s perception that they are pretty similar.</p>
    <li data-md>
     <p>The exposition-only concept <code class="highlight"><i><c- n>scannable</c-></i></code> and <code class="highlight"><i><c- n>scannable</c-><c- o>-</c-><c- n>impl</c-></i></code> is basically the same as <code class="highlight"><i><c- n>indirectly</c-><c- o>-</c-><c- n>binary</c-><c- o>-</c-><c- n>left</c-><c- o>-</c-><c- n>foldable</c-></i></code> and <code class="highlight"><i><c- n>indirectly</c-><c- o>-</c-><c- n>binary</c-><c- o>-</c-><c- n>left</c-><c- o>-</c-><c- n>foldable</c-><c- o>-</c-><c- n>impl</c-></i></code>; the only difference is that <code class="highlight"><c- n>F</c-></code> is required to be move constructible instead of copy constructible.</p>
   </ul>
   <h3 class="heading settled" data-level="6.1" id="version.syn"><span class="secno">6.1. </span><span class="content">17.3.2 Header <code class="highlight"><c- o>&lt;</c-><c- n>version</c-><c- o>></c-></code> synopsis [version.syn]</span><a class="self-link" href="#version.syn"></a></h3>
   <p>In this clause’s synopsis, insert a new macro definition in a place that respects the current alphabetical order of the synopsis, and substituting <code class="highlight"><c- mi>20</c-><c- n>XXYYL</c-></code> by the date of adoption.</p>
<pre class="highlight"><ins><c- cp>#define __cpp_lib_ranges_scan 20XXYYL </c-><c- c1>// freestanding, also in &lt;ranges></c-></ins>
</pre>
   <h3 class="heading settled" data-level="6.2" id="ranges.syn"><span class="secno">6.2. </span><span class="content">25.2 Header <code class="highlight"><c- o>&lt;</c-><c- n>ranges</c-><c- o>></c-></code> synopsis [ranges.syn]</span><a class="self-link" href="#ranges.syn"></a></h3>
   <p>Modify the synopsis as follows:</p>
<pre class="highlight"><c- c1>// [...]</c->
<c- k>namespace</c-> <c- nn>std</c-><c- o>::</c-><c- nn>ranges</c-> <c- p>{</c->
  <c- c1>// [...]</c->
  <c- c1>// [range.transform], transform view</c->
  <c- k>template</c-><c- o>&lt;</c-><c- n>input_range</c-> <c- n>V</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>F</c-><c- p>,</c-> <c- b>bool</c-> <c- n>IsInit</c-><c- o>></c->
    <c- k>requires</c-> <c- n>view</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>is_object_v</c-><c- o>&lt;</c-><c- n>F</c-><c- o>></c-> <c- o>&amp;&amp;</c->
             <c- n>regular_invocable</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>></c-> <c- o>&amp;&amp;</c->
             <i><c- n>can</c-><c- o>-</c-><c- n>reference</c-></i><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>>></c->
  <c- k>class</c-> <c- nc>transform_view</c-><c- p>;</c-> <c- c1>// freestanding</c->

  <c- k>namespace</c-> <c- nn>views</c-> <c- p>{</c-> <c- kr>inline</c-> <c- k>constexpr</c-> <i><c- n>unspecified</c-></i> <c- n>transform</c-> <c- o>=</c-> <i><c- n>unspecified</c-></i><c- p>;</c-> <c- p>}</c-> <c- c1>// freestanding</c->

  <ins><c- c1>// [range.scan], scan view</c->
  <c- k>template</c-><c- o>&lt;</c-><c- n>input_range</c-> <c- n>V</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>F</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>T</c-><c- p>,</c-> <c- b>bool</c-> <c- n>IsInit</c-><c- o>></c->
    <c- k>requires</c-> <i><c- n>see</c-> <c- n>below</c-></i>
  <c- k>class</c-> <c- nc>scan_view</c-><c- p>;</c-> <c- c1>// freestanding</c->

  <c- k>namespace</c-> <c- nn>views</c-> <c- p>{</c->
    <c- kr>inline</c-> <c- k>constexpr</c-> <i><c- n>unspecified</c-></i> <c- n>scan</c-> <c- o>=</c-> <i><c- n>unspecified</c-></i><c- p>;</c-> <c- c1>// freestanding</c->
    <c- kr>inline</c-> <c- k>constexpr</c-> <i><c- n>unspecified</c-></i> <c- n>prefix_sum</c-> <c- o>=</c-> <i><c- n>unspecified</c-></i><c- p>;</c-> <c- c1>// freestanding</c->
  <c- p>}</c-></ins>

  <c- c1>// [range.take], take view</c->
  <c- k>template</c-><c- o>&lt;</c-><c- n>view</c-><c- o>></c-> <c- k>class</c-> <c- nc>take_view</c-><c- p>;</c-> <c- c1>// freestanding</c->

  <c- k>template</c-><c- o>&lt;</c-><c- k>class</c-> <c- nc>T</c-><c- o>></c->
    <c- k>constexpr</c-> <c- b>bool</c-> <c- n>enable_borrowed_range</c-><c- o>&lt;</c-><c- n>take_view</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>></c-> <c- o>=</c->
      <c- n>enable_borrowed_range</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-><c- p>;</c-> <c- c1>// freestanding</c->

  <c- k>namespace</c-> <c- nn>views</c-> <c- p>{</c-> <c- kr>inline</c-> <c- k>constexpr</c-> <i><c- n>unspecified</c-></i> <c- n>take</c-> <c- o>=</c-> <i><c- n>unspecified</c-></i><c- p>;</c-> <c- p>}</c-> <c- c1>// freestanding</c->
  <c- c1>// [...]</c->
<c- p>}</c->
</pre>
   <p><em>Editor’s Note: Add the following subclause to 25.7 Range adaptors [range.adaptors], after 25.7.9 Transform view [range.transform]</em></p>
   <h3 class="heading settled" data-level="6.3" id="range.scan"><span class="secno">6.3. </span><span class="content">25.7.� Scan view [range.scan]</span><a class="self-link" href="#range.scan"></a></h3>
   <h3 class="heading settled" data-level="6.4" id="range.scan.overview"><span class="secno">6.4. </span><span class="content">25.7.�.1 Overview [range.scan.overview]</span><a class="self-link" href="#range.scan.overview"></a></h3>
   <ol>
    <li data-md>
     <p><code class="highlight"><c- n>scan_view</c-></code> presents a view that accumulates the results of applying a transformation function to the current state and each element.</p>
    <li data-md>
     <p>The name <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> denotes a range adaptor object ([range.adaptor.object]). Given subexpressions <code class="highlight"><c- n>E</c-></code>, <code class="highlight"><c- n>F</c-></code> and <code class="highlight"><c- n>G</c-></code>, the expressions <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>F</c-><c- p>)</c-></code> and <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>G</c-><c- p>)</c-></code> are expression-equivalent to <code class="highlight"><c- n>scan_view</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>F</c-><c- p>)</c-></code> and <code class="highlight"><c- n>scan_view</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>G</c-><c- p>)</c-></code>, respectively.</p>
   </ol>
   <p>[<em>Example 1</em>:</p>
<pre class="language-cpp highlight"><c- n>vector</c-><c- o>&lt;</c-><c- b>int</c-><c- o>></c-> <c- n>vec</c-><c- p>{</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>,</c-> <c- mi>4</c-><c- p>,</c-> <c- mi>5</c-><c- p>};</c->
<c- k>for</c-> <c- p>(</c-><c- k>auto</c-><c- o>&amp;&amp;</c-> <c- n>i</c-> <c- o>:</c-> <c- n>std</c-><c- o>::</c-><c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c-><c- n>vec</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{}))</c-> <c- p>{</c->
  <c- n>std</c-><c- o>::</c-><c- n>print</c-><c- p>(</c-><c- s>"{} "</c-><c- p>,</c-> <c- n>i</c-><c- p>);</c-> <c- c1>// prints 1 3 6 10 15 </c->
<c- p>}</c->
<c- k>for</c-> <c- p>(</c-><c- k>auto</c-><c- o>&amp;&amp;</c-> <c- n>i</c-> <c- o>:</c-> <c- n>std</c-><c- o>::</c-><c- n>views</c-><c- o>::</c-><c- n>scan</c-><c- p>(</c-><c- n>vec</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{},</c-> <c- mi>10</c-><c- p>))</c-> <c- p>{</c->
  <c- n>std</c-><c- o>::</c-><c- n>print</c-><c- p>(</c-><c- s>"{} "</c-><c- p>,</c-> <c- n>i</c-><c- p>);</c-> <c- c1>// prints 11 13 16 20 25 </c->
<c- p>}</c->
</pre>
   <p>-- <em>end example</em>]</p>
   <ol start="3">
    <li data-md>
     <p>The name <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-></code> denotes a range adaptor object ([range.adaptor.object]). Given subexpression <code class="highlight"><c- n>E</c-></code>, the expressions <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-><c- p>(</c-><c- n>E</c-><c- p>)</c-></code> and <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>F</c-><c- p>)</c-></code> are expression-equivalent to <code class="highlight"><c- n>scan_view</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{})</c-></code> and <code class="highlight"><c- n>scan_view</c-><c- p>(</c-><c- n>E</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{},</c-> <c- n>F</c-><c- p>)</c-></code>, respectively.</p>
   </ol>
   <h3 class="heading settled" data-level="6.5" id="range.scan.view"><span class="secno">6.5. </span><span class="content">25.7.�.2 Class template <code class="highlight"><c- n>scan_view</c-></code> [range.scan.view]</span><a class="self-link" href="#range.scan.view"></a></h3>
<pre class="highlight"><c- k>namespace</c-> <c- nn>std</c-><c- o>::</c-><c- nn>ranges</c-> <c- p>{</c->
  <c- k>template</c-><c- o>&lt;</c-><c- k>typename</c-> <c- nc>V</c-><c- p>,</c-> <c- k>typename</c-> <c- nc>F</c-><c- p>,</c-> <c- k>typename</c-> <c- nc>T</c-><c- p>,</c-> <c- k>typename</c-> <c- nc>U</c-><c- o>></c->
    <c- k>concept</c-> <i><c- nc>scannable</c-><c- o>-</c-><c- n>impl</c-></i> <c- o>=</c->  <c- c1>// exposition only</c->
      <c- n>movable</c-><c- o>&lt;</c-><c- n>U</c-><c- o>></c-> <c- o>&amp;&amp;</c->
      <c- n>convertible_to</c-><c- o>&lt;</c-><c- n>T</c-><c- p>,</c-> <c- n>U</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>invocable</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>U</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>></c-> <c- o>&amp;&amp;</c->
      <c- n>assignable_from</c-><c- o>&lt;</c-><c- n>U</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>U</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>>></c-><c- p>;</c->

  <c- k>template</c-><c- o>&lt;</c-><c- k>typename</c-> <c- nc>V</c-><c- p>,</c-> <c- k>typename</c-> <c- nc>F</c-><c- p>,</c-> <c- k>typename</c-> <c- nc>T</c-><c- o>></c->
    <c- k>concept</c-> <i><c- nc>scannable</c-></i> <c- o>=</c->  <c- c1>// exposition only</c->
      <c- n>invocable</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>></c-> <c- o>&amp;&amp;</c->
      <c- n>convertible_to</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>></c-><c- p>,</c->
             <c- n>decay_t</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>>>></c-> <c- o>&amp;&amp;</c->
      <i><c- n>scannable</c-><c- o>-</c-><c- n>impl</c-></i><c- o>&lt;</c-><c- n>V</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c->
             <c- n>decay_t</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><c- n>F</c-><c- o>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>>>>></c-><c- p>;</c->

  <c- k>template</c-><c- o>&lt;</c-><c- n>input_range</c-> <c- n>V</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>F</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>T</c-><c- p>,</c-> <c- b>bool</c-> <c- n>IsInit</c-> <c- o>=</c-> false<c- o>></c->
    <c- k>requires</c-> <c- n>view</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>is_object_v</c-><c- o>&lt;</c-><c- n>F</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>is_object_v</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <i><c- n>scannable</c-></i><c- o>&lt;</c-><c- n>V</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- o>></c->
  <c- k>class</c-> <c- nc>scan_view</c-> <c- o>:</c-> <c- k>public</c-> <c- n>view_interface</c-><c- o>&lt;</c-><c- n>scan_view</c-><c- o>&lt;</c-><c- n>V</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>IsInit</c-><c- o>>></c-> <c- p>{</c->
  <c- k>private</c-><c- o>:</c->
    <c- c1>// [range.scan.iterator], class template scan_view::</c-><i><c- c1>iterator</c-></i>
    <c- k>template</c-><c- o>&lt;</c-><c- b>bool</c-><c- o>></c-> <c- k>struct</c-> <i><c- nc>iterator</c-></i><c- p>;</c-> <c- c1>// exposition only</c->

    <c- n>V</c-> <i><c- n>base_</c-></i> <c- o>=</c-> <c- n>V</c-><c- p>();</c-> <c- c1>// exposition only</c->
    <i><c- n>movable</c-><c- o>-</c-><c- n>box</c-></i><c- o>&lt;</c-><c- n>F</c-><c- o>></c-> <i><c- n>fun_</c-></i><c- p>;</c-> <c- c1>// exposition only</c->
    <i><c- n>movable</c-><c- o>-</c-><c- n>box</c-></i><c- o>&lt;</c-><c- n>T</c-><c- o>></c-> <i><c- n>init_</c-></i><c- p>;</c-> <c- c1>// exposition only</c->

  <c- k>public</c-><c- o>:</c->
    <c- n>scan_view</c-><c- p>()</c-> <c- k>requires</c-> <c- n>default_initializable</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>default_initializable</c-><c- o>&lt;</c-><c- n>F</c-><c- o>></c-> <c- o>=</c-> <c- k>default</c-><c- p>;</c->
    <c- k>constexpr</c-> <c- k>explicit</c-> <c- n>scan_view</c-><c- p>(</c-><c- n>V</c-> <c- n>base</c-><c- p>,</c-> <c- n>F</c-> <c- n>fun</c-><c- p>)</c-> <c- k>requires</c-> <c- p>(</c-><c- o>!</c-><c- n>IsInit</c-><c- p>);</c->
    <c- k>constexpr</c-> <c- k>explicit</c-> <c- n>scan_view</c-><c- p>(</c-><c- n>V</c-> <c- n>base</c-><c- p>,</c-> <c- n>F</c-> <c- n>fun</c-><c- p>,</c-> <c- n>T</c-> <c- n>init</c-><c- p>)</c-> <c- k>requires</c-> <c- n>IsInit</c-><c- p>;</c->

    <c- k>constexpr</c-> <c- n>V</c-> <c- nf>base</c-><c- p>()</c-> <c- k>const</c-> <c- o>&amp;</c-> <c- k>requires</c-> <c- n>copy_constructible</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-> <c- p>{</c-> <c- k>return</c-> <i><c- n>base_</c-></i><c- p>;</c-> <c- p>}</c->
    <c- k>constexpr</c-> <c- n>V</c-> <c- nf>base</c-><c- p>()</c-> <c- o>&amp;&amp;</c-> <c- p>{</c-> <c- k>return</c-> <c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>);</c-> <c- p>}</c->

    <c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- o>&lt;</c->false<c- o>></c-> <c- n>begin</c-><c- p>();</c->
    <c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- o>&lt;</c->true<c- o>></c-> <c- n>begin</c-><c- p>()</c-> <c- k>const</c->
      <c- k>requires</c-> <c- n>range</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>V</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <i><c- n>scannable</c-></i><c- o>&lt;</c-><c- k>const</c-> <c- n>V</c-><c- p>,</c-> <c- k>const</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- o>></c-><c- p>;</c->

    <c- k>constexpr</c-> <c- n>default_sentinel_t</c-> <c- nf>end</c-><c- p>()</c-> <c- k>const</c-> <c- k>noexcept</c-> <c- p>{</c-> <c- k>return</c-> <c- n>default_sentinel</c-><c- p>;</c-> <c- p>}</c->

    <c- k>constexpr</c-> <c- k>auto</c-> <c- n>size</c-><c- p>()</c-> <c- k>requires</c-> <c- n>sized_range</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-> <c- p>{</c-> <c- k>return</c-> <c- n>ranges</c-><c- o>::</c-><c- n>size</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>);</c-> <c- p>}</c->
    <c- k>constexpr</c-> <c- k>auto</c-> <c- n>size</c-><c- p>()</c-> <c- k>const</c-> <c- k>requires</c-> <c- n>sized_range</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>V</c-><c- o>></c->
    <c- p>{</c-> <c- k>return</c-> <c- n>ranges</c-><c- o>::</c-><c- n>size</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>);</c-> <c- p>}</c->

    <c- k>constexpr</c-> <c- k>auto</c-> <c- n>reserve_hint</c-><c- p>()</c-> <c- k>requires</c-> <c- n>approximately_sized_range</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c->
    <c- p>{</c-> <c- k>return</c-> <c- n>ranges</c-><c- o>::</c-><c- n>reserve_hint</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>);</c-> <c- p>}</c->

    <c- k>constexpr</c-> <c- k>auto</c-> <c- n>reserve_hint</c-><c- p>()</c-> <c- k>const</c-> <c- k>requires</c-> <c- n>approximately_sized_range</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>V</c-><c- o>></c->
    <c- p>{</c-> <c- k>return</c-> <c- n>ranges</c-><c- o>::</c-><c- n>reserve_hint</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>);</c-> <c- p>}</c->
  <c- p>};</c->

  <c- k>template</c-><c- o>&lt;</c-><c- k>class</c-> <c- nc>R</c-><c- p>,</c-> <c- k>class</c-> <c- nc>F</c-><c- o>></c->
    <c- n>scan_view</c-><c- p>(</c-><c- n>R</c-><c- o>&amp;&amp;</c-><c- p>,</c-> <c- n>F</c-><c- p>)</c-> <c- o>-></c-> <c- n>scan_view</c-><c- o>&lt;</c-><c- n>views</c-><c- o>::</c-><c- n>all_t</c-><c- o>&lt;</c-><c- n>R</c-><c- o>></c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>range_value_t</c-><c- o>&lt;</c-><c- n>R</c-><c- o>></c-><c- p>,</c-> false<c- o>></c-><c- p>;</c->
  <c- k>template</c-><c- o>&lt;</c-><c- k>class</c-> <c- nc>R</c-><c- p>,</c-> <c- k>class</c-> <c- nc>F</c-><c- p>,</c-> <c- k>class</c-> <c- nc>T</c-><c- o>></c->
    <c- n>scan_view</c-><c- p>(</c-><c- n>R</c-><c- o>&amp;&amp;</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- p>)</c-> <c- o>-></c-> <c- n>scan_view</c-><c- o>&lt;</c-><c- n>views</c-><c- o>::</c-><c- n>all_t</c-><c- o>&lt;</c-><c- n>R</c-><c- o>></c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> true<c- o>></c-><c- p>;</c->
<c- p>}</c->
</pre>
<pre class="language-cpp highlight"><c- k>constexpr</c-> <c- k>explicit</c-> <c- n>scan_view</c-><c- p>(</c-><c- n>V</c-> <c- n>base</c-><c- p>,</c-> <c- n>F</c-> <c- n>fun</c-><c- p>)</c-> <c- k>requires</c-> <c- p>(</c-><c- o>!</c-><c- n>IsInit</c-><c- p>);</c->
</pre>
   <ol>
    <li data-md>
     <p><em>Effects</em>: Initializes <code class="highlight"><i><c- n>base_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>base</c-><c- p>)</c-></code> and <code class="highlight"><i><c- n>fun_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>fun</c-><c- p>)</c-></code>.</p>
   </ol>
<pre class="language-cpp highlight"><c- k>constexpr</c-> <c- k>explicit</c-> <c- n>scan_view</c-><c- p>(</c-><c- n>V</c-> <c- n>base</c-><c- p>,</c-> <c- n>F</c-> <c- n>fun</c-><c- p>,</c-> <c- n>T</c-> <c- n>init</c-><c- p>)</c-> <c- k>requires</c-> <c- n>IsInit</c-><c- p>;</c->
</pre>
   <ol start="2">
    <li data-md>
     <p><em>Effects</em>: Initializes <code class="highlight"><i><c- n>base_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>base</c-><c- p>)</c-></code>, <code class="highlight"><i><c- n>fun_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>fun</c-><c- p>)</c-></code>, and <code class="highlight"><i><c- n>init_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>init</c-><c- p>)</c-></code>.</p>
   </ol>
<pre class="highlight"><c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- o>&lt;</c->false<c- o>></c-> <c- n>begin</c-><c- p>();</c->
</pre>
   <ol start="3">
    <li data-md>
     <p><em>Effects</em>: Equivalent to: <code class="highlight"><c- k>return</c-> <i><c- n>iterator</c-></i><c- o>&lt;</c->false<c- o>></c-><c- p>{</c-><c- o>*</c-><c- k>this</c-><c- p>,</c-> <c- n>ranges</c-><c- o>::</c-><c- n>begin</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>)};</c-></code></p>
   </ol>
<pre class="highlight"><c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- o>&lt;</c->true<c- o>></c-> <c- n>begin</c-><c- p>()</c-> <c- k>const</c->
  <c- k>requires</c-> <c- n>range</c-><c- o>&lt;</c-><c- k>const</c-> <c- n>V</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <i><c- n>scannable</c-></i><c- o>&lt;</c-><c- k>const</c-> <c- n>V</c-><c- p>,</c-> <c- k>const</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- o>></c-><c- p>;</c->
</pre>
   <ol start="4">
    <li data-md>
     <p><em>Effects</em>: Equivalent to: <code class="highlight"><c- k>return</c-> <i><c- n>iterator</c-></i><c- o>&lt;</c->true<c- o>></c-><c- p>{</c-><c- o>*</c-><c- k>this</c-><c- p>,</c-> <c- n>ranges</c-><c- o>::</c-><c- n>begin</c-><c- p>(</c-><i><c- n>base_</c-></i><c- p>)};</c-></code></p>
   </ol>
   <h3 class="heading settled" data-level="6.6" id="range.scan.iterator"><span class="secno">6.6. </span><span class="content">25.7.�.3 Class template <code class="highlight"><c- n>scan_view</c-><c- o>::</c-><i><c- n>iterator</c-></i></code> [range.scan.iterator]</span><a class="self-link" href="#range.scan.iterator"></a></h3>
<pre class="highlight"><c- k>namespace</c-> <c- nn>std</c-><c- o>::</c-><c- nn>ranges</c-> <c- p>{</c->
  <c- k>template</c-><c- o>&lt;</c-><c- n>input_range</c-> <c- n>V</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>F</c-><c- p>,</c-> <c- n>move_constructible</c-> <c- n>T</c-><c- p>,</c-> <c- b>bool</c-> <c- n>IsInit</c-><c- o>></c->
    <c- k>requires</c-> <c- n>view</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>is_object_v</c-><c- o>&lt;</c-><c- n>F</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>is_object_v</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <i><c- n>scannable</c-></i><c- o>&lt;</c-><c- n>V</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- o>></c->
  <c- k>template</c-><c- o>&lt;</c-><c- b>bool</c-> <c- n>Const</c-><c- o>></c->
  <c- k>class</c-> <c- nc>scan_view</c-><c- o>&lt;</c-><c- n>V</c-><c- p>,</c-> <c- n>F</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>IsInit</c-><c- o>>::</c-><i><c- n>iterator</c-></i> <c- p>{</c->
  <c- k>private</c-><c- o>:</c->
    <c- k>using</c-> <i><c- n>Parent</c-></i> <c- o>=</c-> <i><c- n>maybe</c-><c- o>-</c-><c- k>const</c-></i><c- o>&lt;</c-><c- n>Const</c-><c- p>,</c-> <c- n>scan_view</c-><c- o>></c-><c- p>;</c-> <c- c1>// exposition only</c->
    <c- k>using</c-> <i><c- n>Base</c-></i> <c- o>=</c-> <i><c- n>maybe</c-><c- o>-</c-><c- k>const</c-></i><c- o>&lt;</c-><c- n>Const</c-><c- p>,</c-> <c- n>V</c-><c- o>></c-><c- p>;</c-> <c- c1>// exposition only</c->
    <c- k>using</c-> <i><c- n>ResultType</c-></i> <c- o>=</c-> <c- n>decay_t</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><i><c- n>maybe</c-><c- o>-</c-><c- k>const</c-></i><c- o>&lt;</c-><c- n>Const</c-><c- p>,</c-> <c- n>F</c-><c- o>>&amp;</c-><c- p>,</c-> <c- n>T</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>>></c-><c- p>;</c-> <c- c1>// exposition only</c->

    <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-> <i><c- n>current_</c-></i> <c- o>=</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-><c- p>();</c-> <c- c1>// exposition only</c->
    <i><c- n>Parent</c-></i><c- o>*</c-> <i><c- n>parent_</c-></i> <c- o>=</c-> <c- k>nullptr</c-><c- p>;</c-> <c- c1>// exposition only</c->
    <i><c- n>movable</c-><c- o>-</c-><c- n>box</c-></i><c- o>&lt;</c-><i><c- n>ResultType</c-></i><c- o>></c-> <i><c- n>sum_</c-></i><c- p>;</c-> <c- c1>// exposition only</c->

  <c- k>public</c-><c- o>:</c->
    <c- k>using</c-> <c- n>iterator_concept</c-> <c- o>=</c->
      <c- n>conditional_t</c-><c- o>&lt;</c-><c- n>forward_range</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-><c- p>,</c-> <c- n>forward_iterator_tag</c-><c- p>,</c-> <c- n>input_iterator_tag</c-><c- o>></c-><c- p>;</c->
    <c- k>using</c-> <c- n>iterator_category</c-> <c- o>=</c-> <i><c- n>see</c-> <c- n>below</c-></i><c- p>;</c-> <c- c1>// present only if </c-><i><c- c1>Base</c-></i><c- c1> models forward_range</c->
    <c- k>using</c-> <c- n>value_type</c-> <c- o>=</c-> <i><c- n>ResultType</c-></i><c- p>;</c->
    <c- k>using</c-> <c- n>difference_type</c-> <c- o>=</c-> <c- n>range_difference_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-><c- p>;</c->

    <i><c- n>iterator</c-></i><c- p>()</c-> <c- k>requires</c-> <c- n>default_initializable</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>></c-> <c- o>=</c-> <c- k>default</c-><c- p>;</c->
    <c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- p>(</c-><i><c- n>Parent</c-></i><c- o>&amp;</c-> <c- n>parent</c-><c- p>,</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-> <c- n>current</c-><c- p>);</c->
    <c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- p>(</c-><i><c- n>iterator</c-></i><c- o>&lt;!</c-><c- n>Const</c-><c- o>></c-> <c- n>i</c-><c- p>)</c->
      <c- k>requires</c-> <c- n>Const</c-> <c- o>&amp;&amp;</c-> <c- n>convertible_to</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-><c- p>,</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>></c-><c- p>;</c->

    <c- k>constexpr</c-> <c- k>const</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>&amp;</c-> <c- n>base</c-><c- p>()</c-> <c- k>const</c-> <c- o>&amp;</c-> <c- k>noexcept</c-> <c- p>{</c-> <c- k>return</c-> <i><c- n>current_</c-></i><c- p>;</c-> <c- p>}</c->
    <c- k>constexpr</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-> <c- n>base</c-><c- p>()</c-> <c- o>&amp;&amp;</c-> <c- p>{</c-> <c- k>return</c-> <c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><i><c- n>current_</c-></i><c- p>);</c-> <c- p>}</c->

    <c- k>constexpr</c-> <c- k>const</c-> <c- n>value_type</c-><c- o>&amp;</c-> <c- k>operator</c-><c- o>*</c-><c- p>()</c-> <c- k>const</c-> <c- p>{</c-> <c- k>return</c-> <c- o>*</c-><i><c- n>sum_</c-></i><c- p>;</c-> <c- p>}</c->

    <c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- k>operator</c-><c- o>++</c-><c- p>();</c->
    <c- k>constexpr</c-> <c- b>void</c-> <c- k>operator</c-><c- o>++</c-><c- p>(</c-><c- b>int</c-><c- p>);</c->
    <c- k>constexpr</c-> <i><c- n>iterator</c-></i> <c- k>operator</c-><c- o>++</c-><c- p>(</c-><c- b>int</c-><c- p>)</c-> <c- k>requires</c-> <c- n>forward_range</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-><c- p>;</c->

    <c- k>friend</c-> <c- k>constexpr</c-> <c- b>bool</c-> <c- k>operator</c-><c- o>==</c-><c- p>(</c-><c- k>const</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- n>x</c-><c- p>,</c-> <c- k>const</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- n>y</c-><c- p>)</c->
      <c- k>requires</c-> <c- n>equality_comparable</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>></c-><c- p>;</c->
    <c- k>friend</c-> <c- k>constexpr</c-> <c- b>bool</c-> <c- k>operator</c-><c- o>==</c-><c- p>(</c-><c- k>const</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- n>x</c-><c- p>,</c-> <c- n>default_sentinel_t</c-><c- p>);</c->
  <c- p>};</c->
<c- p>}</c->
</pre>
   <ol>
    <li data-md>
     <p>If <code class="highlight"><i><c- n>Base</c-></i></code> does not model <code class="highlight"><c- n>forward_range</c-></code> there is no member <code class="highlight"><c- n>iterator_category</c-></code>. Otherwise, the <em>typedef-name</em> <code class="highlight"><c- n>iterator_category</c-></code> denotes:</p>
   </ol>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>forward_iterator_tag</c-></code> if <code class="highlight"><c- n>iterator_traits</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>>::</c-><c- n>iterator_category</c-></code> models <code class="highlight"><c- n>derived_from</c-><c- o>&lt;</c-><c- n>forward_iterator_tag</c-><c- o>></c-></code> and <code class="highlight"><c- n>is_reference_v</c-><c- o>&lt;</c-><c- n>invoke_result_t</c-><c- o>&lt;</c-><i><c- n>maybe</c-><c- o>-</c-><c- k>const</c-></i><c- o>&lt;</c-><c- n>Const</c-><c- p>,</c-> <c- n>F</c-><c- o>>&amp;</c-><c- p>,</c-> <i><c- n>maybe</c-><c- o>-</c-><c- k>const</c-></i><c- o>&lt;</c-><c- n>Const</c-><c- p>,</c-> <c- n>T</c-><c- o>>&amp;</c-><c- p>,</c-> <c- n>range_reference_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>>></c-></code> is <code class="highlight">true</code>;</p>
    <li data-md>
     <p>otherwise, <code class="highlight"><c- n>input_iterator_tag</c-></code>.</p>
   </ul>
<pre class="highlight"><c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- p>(</c-><i><c- n>Parent</c-></i><c- o>&amp;</c-> <c- n>parent</c-><c- p>,</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-> <c- n>current</c-><c- p>);</c->
</pre>
   <ol start="2">
    <li data-md>
     <p><em>Effects</em>: Initializes <code class="highlight"><i><c- n>current_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>current</c-><c- p>)</c-></code> and <code class="highlight"><i><c- n>parent_</c-></i></code> with <code class="highlight"><c- n>addressof</c-><c- p>(</c-><c- n>parent</c-><c- p>)</c-></code>. Then, equivalent to:</p>
   </ol>
<pre class="highlight"><c- k>if</c-> <c- p>(</c-><i><c- n>current_</c-></i> <c- o>==</c-> <c- n>ranges</c-><c- o>::</c-><c- n>end</c-><c- p>(</c-><i><c- n>parent_</c-></i><c- o>-></c-><i><c- n>base_</c-></i><c- p>))</c-> <c- k>return</c-><c- p>;</c->
<c- k>if</c-> <c- k>constexpr</c-> <c- p>(</c-><c- n>IsInit</c-><c- p>)</c-> <c- p>{</c->
  <i><c- n>sum_</c-></i> <c- o>=</c-> <c- n>invoke</c-><c- p>(</c-><c- o>*</c-><i><c- n>parent_</c-></i><c- o>-></c-><i><c- n>fun_</c-></i><c- p>,</c-> <c- o>*</c-><i><c- n>parent_</c-></i><c- o>-></c-><i><c- n>init_</c-></i><c- p>,</c-> <c- o>*</c-><i><c- n>current_</c-></i><c- p>);</c->
<c- p>}</c-> <c- k>else</c-> <c- p>{</c->
  <i><c- n>sum_</c-></i> <c- o>=</c-> <c- o>*</c-><i><c- n>current_</c-></i><c- p>;</c->
<c- p>}</c->
</pre>
<pre class="highlight"><c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- p>(</c-><i><c- n>iterator</c-></i><c- o>&lt;!</c-><c- n>Const</c-><c- o>></c-> <c- n>i</c-><c- p>)</c->
  <c- k>requires</c-> <c- n>Const</c-> <c- o>&amp;&amp;</c-> <c- n>convertible_to</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><c- n>V</c-><c- o>></c-><c- p>,</c-> <c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>></c-><c- p>;</c->
</pre>
   <ol start="3">
    <li data-md>
     <p><em>Effects</em>: Initializes <code class="highlight"><i><c- n>current_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>i</c-><c- p>.</c-><i><c- n>current_</c-></i><c- p>)</c-></code>, <code class="highlight"><i><c- n>parent_</c-></i></code> with <code class="highlight"><c- n>i</c-><c- p>.</c-><i><c- n>parent_</c-></i></code>, and <code class="highlight"><i><c- n>sum_</c-></i></code> with <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- n>i</c-><c- p>.</c-><i><c- n>sum_</c-></i><c- p>)</c-></code>.</p>
   </ol>
<pre class="highlight"><c- k>constexpr</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- k>operator</c-><c- o>++</c-><c- p>();</c->
</pre>
   <ol start="4">
    <li data-md>
     <p><em>Effects</em>: Equivalent to:</p>
   </ol>
<pre class="highlight"><c- k>if</c-> <c- p>(</c-><c- o>++</c-><i><c- n>current_</c-></i> <c- o>!=</c-> <c- n>ranges</c-><c- o>::</c-><c- n>end</c-><c- p>(</c-><i><c- n>parent_</c-></i><c- o>-></c-><i><c- n>base_</c-></i><c- p>))</c-> <c- p>{</c->
  <i><c- n>sum_</c-></i> <c- o>=</c-> <c- n>invoke</c-><c- p>(</c-><c- o>*</c-><i><c- n>parent_</c-></i><c- o>-></c-><i><c- n>fun_</c-></i><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>move</c-><c- p>(</c-><c- o>*</c-><i><c- n>sum_</c-></i><c- p>),</c-> <c- o>*</c-><i><c- n>current_</c-></i><c- p>);</c->
<c- p>}</c->
<c- k>return</c-> <c- o>*</c-><c- k>this</c-><c- p>;</c->
</pre>
<pre class="language-cpp highlight"><c- k>constexpr</c-> <c- b>void</c-> <c- k>operator</c-><c- o>++</c-><c- p>(</c-><c- b>int</c-><c- p>);</c->
</pre>
   <ol start="5">
    <li data-md>
     <p><em>Effects</em>: Equivalent to <code class="highlight"><c- o>++*</c-><c- k>this</c-></code>.</p>
   </ol>
<pre class="highlight"><c- k>constexpr</c-> <i><c- n>iterator</c-></i> <c- k>operator</c-><c- o>++</c-><c- p>(</c-><c- b>int</c-><c- p>)</c-> <c- k>requires</c-> <c- n>forward_range</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>></c-><c- p>;</c->
</pre>
   <ol start="6">
    <li data-md>
     <p><em>Effects</em>: Equivalent to:</p>
   </ol>
<pre class="language-cpp highlight"><c- k>auto</c-> <c- n>tmp</c-> <c- o>=</c-> <c- o>*</c-><c- k>this</c-><c- p>;</c->
<c- o>++*</c-><c- k>this</c-><c- p>;</c->
<c- k>return</c-> <c- n>tmp</c-><c- p>;</c->
</pre>
<pre class="highlight"><c- k>friend</c-> <c- k>constexpr</c-> <c- b>bool</c-> <c- k>operator</c-><c- o>==</c-><c- p>(</c-><c- k>const</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- n>x</c-><c- p>,</c-> <c- k>const</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- n>y</c-><c- p>)</c->
  <c- k>requires</c-> <c- n>equality_comparable</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><i><c- n>Base</c-></i><c- o>>></c-><c- p>;</c->
</pre>
   <ol start="7">
    <li data-md>
     <p><em>Effects</em>: Equivalent to: <code class="highlight"><c- k>return</c-> <c- n>x</c-><c- p>.</c-><i><c- n>current_</c-></i> <c- o>==</c-> <c- n>y</c-><c- p>.</c-><i><c- n>current_</c-></i><c- p>;</c-></code></p>
   </ol>
<pre class="highlight"><c- k>friend</c-> <c- k>constexpr</c-> <c- b>bool</c-> <c- k>operator</c-><c- o>==</c-><c- p>(</c-><c- k>const</c-> <i><c- n>iterator</c-></i><c- o>&amp;</c-> <c- n>x</c-><c- p>,</c-> <c- n>default_sentinel_t</c-><c- p>);</c->
</pre>
   <ol start="8">
    <li data-md>
     <p><em>Effects</em>: Equivalent to: <code class="highlight"><c- k>return</c-> <c- n>x</c-><c- p>.</c-><i><c- n>current_</c-></i> <c- o>==</c-> <c- n>ranges</c-><c- o>::</c-><c- n>end</c-><c- p>(</c-><c- n>x</c-><c- p>.</c-><i><c- n>parent_</c-></i><c- o>-></c-><i><c- n>base_</c-></i><c- p>);</c-></code></p>
   </ol>
   <h2 class="heading settled" data-level="7" id="poll-results"><span class="secno">7. </span><span class="content">Poll Results</span><a class="self-link" href="#poll-results"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="sg9-review-wroclaw"><span class="secno">7.1. </span><span class="content">SG9 Review, Wrocław (2024-11)</span><a class="self-link" href="#sg9-review-wroclaw"></a></h3>
    <strong>Poll 1</strong>: We want a view with a convenient spelling for the semantics of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code> without initial value. 
   <table>
    <thead>
     <tr>
      <td>Strongly Favor
      <td>Favor
      <td>Neutral
      <td>Against
      <td>Strongly Against
    <tbody>
     <tr>
      <td>1
      <td>5
      <td>3
      <td>0
      <td>0
   </table>
   <ul>
    <li data-md>
     <p><strong>Attendance</strong>: 10</p>
    <li data-md>
     <p><strong>Author’s Position</strong>: Favor</p>
    <li data-md>
     <p><strong>Outcome</strong>: Consensus.</p>
   </ul>
   <p><strong>Poll 2</strong>: We want a view with a convenient spelling for the semantics of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code> with initial value.</p>
   <table>
    <thead>
     <tr>
      <td>Strongly Favor
      <td>Favor
      <td>Neutral
      <td>Against
      <td>Strongly Against
    <tbody>
     <tr>
      <td>1
      <td>7
      <td>1
      <td>0
      <td>0
   </table>
   <ul>
    <li data-md>
     <p><strong>Attendance</strong>: 10</p>
    <li data-md>
     <p><strong>Author’s Position</strong>: Favor</p>
    <li data-md>
     <p><strong>Outcome</strong>: Consensus. Stronger than Poll 1.</p>
   </ul>
   <p><strong>Poll 3</strong>: We want a view with a convenient spelling for the semantics of <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>exclusive_scan</c-></code> (which would always require an initial value).</p>
   <table>
    <thead>
     <tr>
      <td>Strongly Favor
      <td>Favor
      <td>Neutral
      <td>Against
      <td>Strongly Against
    <tbody>
     <tr>
      <td>0
      <td>3
      <td>6
      <td>1
      <td>0
   </table>
   <ul>
    <li data-md>
     <p><strong>Attendance</strong>: 10</p>
    <li data-md>
     <p><strong>Author’s Position</strong>: Against</p>
    <li data-md>
     <p><strong>Outcome</strong>: Weak consensus.</p>
   </ul>
   <p><strong>Poll 4</strong>: We want a view with a convenient spelling for the semantics of <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>prescan</c-></code> as proposed in the paper (<a data-link-type="biblio" href="#biblio-p3351r1" title="views::scan">[P3351R1]</a>) (<code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>exclusive_scan</c-></code> plus the final sum).</p>
   <table>
    <thead>
     <tr>
      <td>Strongly Favor
      <td>Favor
      <td>Neutral
      <td>Against
      <td>Strongly Against
    <tbody>
     <tr>
      <td>1
      <td>2
      <td>4
      <td>2
      <td>0
   </table>
   <ul>
    <li data-md>
     <p><strong>Attendance</strong>: 10</p>
    <li data-md>
     <p><strong>Author’s Position</strong>: Favor</p>
    <li data-md>
     <p><strong>Outcome</strong>: No consensus either way. Author’s choice.</p>
   </ul>
   <h2 class="heading settled" data-level="8" id="historical-records"><span class="secno">8. </span><span class="content">Historical Records</span><a class="self-link" href="#historical-records"></a></h2>
   <p class="note" role="note"><span class="marker">NOTE:</span> These sections are now obsolete and no longer affects the current design. They only serve as a historical record.</p>
   <h3 class="heading settled" data-level="8.1" id="why-three-adaptors"><span class="secno">8.1. </span><span class="content">Why Three Adaptors? (Obsolete)</span><a class="self-link" href="#why-three-adaptors"></a></h3>
   <p>An immediately obvious question is why choose three names, instead of opting for a single <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> adaptor with overloads that take initial seed and/or function parameter? Such a design will look like this (greatly simplified):</p>
<pre class="language-cpp highlight"><c- k>struct</c-> <c- nc>scan_closure</c->
<c- p>{</c->
    <c- k>template</c-><c- o>&lt;</c-><c- n>ranges</c-><c- o>::</c-><c- n>input_range</c-> <c- n>Rng</c-><c- p>,</c-> <c- k>typename</c-> <c- nc>T</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>copy_constructible</c-> <c- n>Fun</c-> <c- o>=</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- o>></c->
    <c- k>requires</c-> <c- d>/* ... */</c->
    <c- k>constexpr</c-> <c- k>operator</c-><c- p>()(</c-><c- n>Rng</c-><c- o>&amp;&amp;</c-> <c- n>rng</c-><c- p>,</c-> <c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-> <c- n>init</c-><c- p>,</c-> <c- n>Func</c-> <c- n>func</c-> <c- o>=</c-> <c- p>{})</c->
    <c- p>{</c-> <c- d>/* ... */</c-> <c- p>}</c->
    
    <c- k>template</c-><c- o>&lt;</c-><c- n>ranges</c-><c- o>::</c-><c- n>input_range</c-> <c- n>Rng</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>copy_constructible</c-> <c- n>Fun</c-> <c- o>=</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- o>></c->
    <c- k>requires</c-> <c- d>/* ... */</c->
    <c- k>constexpr</c-> <c- k>operator</c-><c- p>()(</c-><c- n>Rng</c-><c- o>&amp;&amp;</c-> <c- n>rng</c-><c- p>,</c-> <c- n>Func</c-> <c- n>func</c-> <c- o>=</c-> <c- p>{})</c->
    <c- p>{</c-> <c- d>/* ... */</c-> <c- p>}</c->
<c- p>};</c->
<c- kr>inline</c-> <c- k>constexpr</c-> <c- n>scan_closure</c-> <c- n>scan</c-><c- p>{};</c->
</pre>
   <p>Unfortunately, this does not work due to the same kind of ambiguity that caused <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>join_with</c-></code> (<a data-link-type="biblio" href="#biblio-p2441r2" title="views::join_with">[P2441R2]</a>) to choose a different name instead of overload with <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>join</c-></code>. Specifically, imagine someone writes a custom <code class="highlight"><c- n>vector</c-></code> that replicates all the original interface, but introduced <code class="highlight"><c- k>operator</c-><c- o>+</c-></code> to mean range concatenation and broadcast:</p>
<pre class="language-cpp highlight"><c- k>template</c-><c- o>&lt;</c-><c- k>typename</c-> <c- nc>T</c-><c- o>></c->
<c- k>struct</c-> <c- nc>my_vector</c-> <c- o>:</c-> <c- k>public</c-> <c- n>std</c-><c- o>::</c-><c- n>vector</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c->
<c- p>{</c->
    <c- k>using</c-> <c- n>std</c-><c- o>::</c-><c- n>vector</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>::</c-><c- n>vector</c-><c- p>;</c->

    <c- c1>// broadcast: [1, 2, 3] + 10 = [11, 12, 13]</c->
    <c- k>friend</c-> <c- n>my_vector</c-> <c- k>operator</c-><c- o>+</c-><c- p>(</c-><c- n>my_vector</c-> <c- n>vec</c-><c- p>,</c-> <c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-> <c- n>value</c-><c- p>)</c->
    <c- p>{</c->
        <c- k>for</c-> <c- p>(</c-><c- k>auto</c-><c- o>&amp;</c-> <c- n>elem</c-> <c- o>:</c-> <c- n>vec</c-><c- p>)</c-> <c- n>elem</c-> <c- o>+=</c-> <c- n>value</c-><c- p>;</c->
        <c- k>return</c-> <c- n>vec</c-><c- p>;</c->
    <c- p>}</c->
    <c- k>friend</c-> <c- n>my_vector</c-> <c- k>operator</c-><c- o>+</c-><c- p>(</c-><c- k>const</c-> <c- n>T</c-><c- o>&amp;</c-> <c- n>value</c-><c- p>,</c-> <c- n>my_vector</c-> <c- n>vec</c-><c- p>)</c-> <c- p>{</c-> <c- d>/* Same */</c-> <c- p>}</c->

    <c- c1>// range concatenation: [1, 2, 3] + [4, 5] = [1, 2, 3, 4, 5]</c->
    <c- k>friend</c-> <c- n>my_vector</c-> <c- k>operator</c-><c- o>+</c-><c- p>(</c-><c- n>my_vector</c-> <c- n>vec</c-><c- p>,</c-> <c- k>const</c-> <c- n>my_vector</c-><c- o>&amp;</c-> <c- n>vec2</c-><c- p>)</c->
    <c- p>{</c->
        <c- n>vec</c-><c- p>.</c-><c- n>append_range</c-><c- p>(</c-><c- n>vec2</c-><c- p>);</c->
        <c- k>return</c-> <c- n>vec</c-><c- p>;</c->
    <c- p>}</c->
    <c- c1>// operator+= implementation omitted</c->
<c- p>};</c->
</pre>
   <p>Although one could argue that this is a misuse of <code class="highlight"><c- k>operator</c-><c- o>+</c-></code> overloading, this is definitely plausible code one could write. Now consider:</p>
<pre class="language-cpp highlight"><c- n>my_vector</c-><c- o>&lt;</c-><c- b>int</c-><c- o>></c-> <c- n>vec</c-><c- p>{</c-><c- mi>1</c-><c- p>,</c-> <c- mi>2</c-><c- p>,</c-> <c- mi>3</c-><c- p>},</c-> <c- n>vec2</c-><c- p>{</c-><c- mi>4</c-><c- p>,</c-> <c- mi>5</c-><c- p>};</c->
<c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-><c- p>(</c-><c- n>vec</c-><c- p>);</c-> <c- c1>// [1, 3, 6]</c->
<c- n>vec2</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-><c- p>(</c-><c- n>vec</c-><c- p>);</c->
<c- c1>// [[1, 2, 3], [5, 6, 7], [10, 11, 12]] (!!)</c->
</pre>
   <p>The second invocation, <code class="highlight"><c- n>vec2</c-> <c- o>|</c-> <c- n>views</c-><c- o>::</c-><c- n>partial_sum</c-><c- p>(</c-><c- n>vec</c-><c- p>)</c-></code>, is equivalent to <code class="highlight"><c- n>partial_sum</c-><c- p>(</c-><c- n>vec2</c-><c- p>,</c-> <c- n>vec</c-><c- p>)</c-></code>, therefore interpreted as "using <code class="highlight"><c- n>vec</c-></code> as the initial seed, and add each element of <code class="highlight"><c- n>vec2</c-></code> to it". Unfortunately, we cannot differentiate the two cases, since they both invoke <code class="highlight"><c- n>partial_sum</c-><c- p>(</c-><c- n>vec</c-><c- p>)</c-></code>. This ambiguity equally affects <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code>, since <code class="highlight"><c- n>scan</c-><c- p>(</c-><c- n>vec</c-><c- p>,</c-> <c- n>plus</c-><c- p>{})</c-></code> and <code class="highlight"><c- n>vec2</c-> <c- o>|</c-> <c- n>scan</c-><c- p>(</c-><c- n>vec</c-><c- p>,</c-> <c- n>plus</c-><c- p>{})</c-></code> are also ambiguous.</p>
   <p>There are several approaches we can adopt to handle this ambiguity:</p>
   <p><strong>Option 1</strong>: Bail out. Simply don’t support the initial seed case, or just declare that anything satisfy <code class="highlight"><c- n>range</c-></code> that comes in the first argument will be treated as the input range.</p>
   <ul>
    <li data-md>
     <p>Pros: No need to decide on new names.</p>
    <li data-md>
     <p>Cons: Losing a valuable use case that was accustomed by users since <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>exclusive_scan</c-></code> exists. If the "declare" option is chosen, then potentially lose more use case like <code class="highlight"><c- n>my_vector</c-></code> and cause some confusion.</p>
   </ul>
   <p><strong>Option 2</strong>: Reorder arguments and bail out. We can switch the function and the initial seed argument, such that the signature is <code class="highlight"><c- n>scan</c-><c- p>(</c-><c- n>rng</c-><c- p>,</c-> <c- n>func</c-><c- p>,</c-> <c- n>init</c-><c- p>)</c-></code>, and declare that anything satisfy <code class="highlight"><c- n>range</c-></code> that comes in the first argument will be treated as the input range.</p>
   <ul>
    <li data-md>
     <p>Pros: No need to decide on new names.</p>
    <li data-md>
     <p>Cons:</p>
     <ul>
      <li data-md>
       <p>Still have potential of conflict if a class that is both a range and a binary functor is passed in</p>
      <li data-md>
       <p>Cannot support <code class="highlight"><c- n>partial_sum</c-></code> with initial seed (discard or need new name)</p>
      <li data-md>
       <p>Inconsistent argument order with <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>fold</c-></code></p>
     </ul>
   </ul>
   <p><strong>Option 3</strong>: Choose separate name for <code class="highlight"><c- n>scan</c-></code> with and without initial seed.</p>
   <ul>
    <li data-md>
     <p>Pros: No potential of conflicts</p>
    <li data-md>
     <p>Cons: Need to decide on 1-2 new names and more wording effort</p>
   </ul>
   <p>The author prefers Option 3 as it is the least surprising option that has no potential of conflicts. For now, the author decides that <code class="highlight"><c- n>scan</c-></code> with an initial seed should be called <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>prescan</c-></code>, as suggested in <a data-link-type="biblio" href="#biblio-p2760r1" title="A Plan for C++26 Ranges">[P2760R1]</a>, and <code class="highlight"><c- n>partial_sum</c-></code> should not support initial seed at all. The rationale for this decision is that people who want <code class="highlight"><c- n>partial_sum</c-></code> with initial seed can simply call <code class="highlight"><c- n>prescan</c-><c- p>(</c-><c- n>init</c-><c- p>,</c-> <c- n>std</c-><c- o>::</c-><c- n>plus</c-><c- p>{})</c-></code>, so instead of coming up a name that is potentially longer and harder to memorize the author felt that this is the best approach.</p>
   <h4 class="heading settled" data-level="8.1.1" id="conflict-sg9-review-wroclaw"><span class="secno">8.1.1. </span><span class="content">SG9 Review, Wrocław (2024-11)</span><a class="self-link" href="#conflict-sg9-review-wroclaw"></a></h4>
    Members of SG9 expressed preference for Option 2, because of several reasons: 
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code> put function before init, which also enables init value to be an optional parameter. This change makes <code class="highlight"><c- n>views</c-><c- o>::</c-><c- n>scan</c-></code> completely equivalent in principle to <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>inclusive_scan</c-></code> in functionality (sans the associativity issue).</p>
    <li data-md>
     <p>The shown conflict case is too arcane and unlikely to cause actual problems in practice.</p>
   </ul>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don't scroll to compensate for the ToC if we're above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don't know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn't exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn't standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don't have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we're at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can't find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-n5001">[N5001]
   <dd>Thomas Köppe. <a href="https://wg21.link/n5001"><cite>Working Draft, Programming Languages — C++</cite></a>. 17 December 2024. URL: <a href="https://wg21.link/n5001">https://wg21.link/n5001</a>
   <dt id="biblio-p2760r1">[P2760R1]
   <dd>Barry Revzin. <a href="https://wg21.link/p2760r1"><cite>A Plan for C++26 Ranges</cite></a>. 15 December 2023. URL: <a href="https://wg21.link/p2760r1">https://wg21.link/p2760r1</a>
   <dt id="biblio-p3351r1">[P3351R1]
   <dd>Yihe Li. <a href="https://wg21.link/p3351r1"><cite>views::scan</cite></a>. 9 October 2024. URL: <a href="https://wg21.link/p3351r1">https://wg21.link/p3351r1</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-n4988">[N4988]
   <dd>Thomas Köppe. <a href="https://wg21.link/n4988"><cite>Working Draft, Programming Languages — C++</cite></a>. 5 August 2024. URL: <a href="https://wg21.link/n4988">https://wg21.link/n4988</a>
   <dt id="biblio-p1642r11">[P1642R11]
   <dd>Ben Craig. <a href="https://wg21.link/p1642r11"><cite>Freestanding Library: Easy [utilities], [ranges], and [iterators]</cite></a>. 1 July 2022. URL: <a href="https://wg21.link/p1642r11">https://wg21.link/p1642r11</a>
   <dt id="biblio-p1729r5">[P1729R5]
   <dd>Elias Kosunen, Victor Zverovich. <a href="https://wg21.link/p1729r5"><cite>Text Parsing</cite></a>. 15 October 2024. URL: <a href="https://wg21.link/p1729r5">https://wg21.link/p1729r5</a>
   <dt id="biblio-p2214r2">[P2214R2]
   <dd>Barry Revzin, Conor Hoekstra, Tim Song. <a href="https://wg21.link/p2214r2"><cite>A Plan for C++23 Ranges</cite></a>. 18 February 2022. URL: <a href="https://wg21.link/p2214r2">https://wg21.link/p2214r2</a>
   <dt id="biblio-p2322r6">[P2322R6]
   <dd>Barry Revzin. <a href="https://wg21.link/p2322r6"><cite>ranges::fold</cite></a>. 22 April 2022. URL: <a href="https://wg21.link/p2322r6">https://wg21.link/p2322r6</a>
   <dt id="biblio-p2441r2">[P2441R2]
   <dd>Barry Revzin. <a href="https://wg21.link/p2441r2"><cite>views::join_with</cite></a>. 28 January 2022. URL: <a href="https://wg21.link/p2441r2">https://wg21.link/p2441r2</a>
   <dt id="biblio-p2846r5">[P2846R5]
   <dd>Corentin Jabot. <a href="https://wg21.link/p2846r5"><cite>reserve_hint: Eagerly reserving memory for not-quite-sized lazy ranges</cite></a>. 27 November 2024. URL: <a href="https://wg21.link/p2846r5">https://wg21.link/p2846r5</a>
   <dt id="biblio-p3117r1">[P3117R1]
   <dd>Zach Laine, Barry Revzin, Jonathan Müller. <a href="https://wg21.link/p3117r1"><cite>Extending Conditionally Borrowed</cite></a>. 15 December 2024. URL: <a href="https://wg21.link/p3117r1">https://wg21.link/p3117r1</a>
   <dt id="biblio-p3136r1">[P3136R1]
   <dd>Tim Song. <a href="https://wg21.link/p3136r1"><cite>Retiring niebloids</cite></a>. 18 November 2024. URL: <a href="https://wg21.link/p3136r1">https://wg21.link/p3136r1</a>
   <dt id="biblio-p3179r4">[P3179R4]
   <dd>Ruslan Arutyunyan, Alexey Kukanov, Bryce Adelstein Lelbach. <a href="https://wg21.link/p3179r4"><cite>C++ parallel range algorithms</cite></a>. 11 December 2024. URL: <a href="https://wg21.link/p3179r4">https://wg21.link/p3179r4</a>
  </dl>